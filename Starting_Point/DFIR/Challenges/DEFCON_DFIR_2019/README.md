<H1>Defcon DFIR CTF 2019</H1>
<p>
<H2>What is it?</H2>
<p></p>
The Defcon DFIR CTF 2019 is a CTF centred around DFIR, it has 5 series of challenges each working on a specific area of forensics. they are:
<p></p>
- DFA Crypto Challenge
<br>
- Deadbox Forensics
<br>
- Linux Forensics
<br>
- Memory Forensics
<br>
- Triage VM Questions
<p></p>
All challenges have the following flag format:
<p></p>

```
flag<ANSWER>
```

<p></p>
<H2>Challenges</H2>
<details>
    <summary></summary>
<p></p>
For the challenges I recommend you attempt them yourself and only go through the walk throughs when you are stuck. This way you will get used to searching for the commands and try a lot of different commands. 
<p></p>
<hr>
<p></p>
<H3>DFA Crypto Challenge</H3>
<p></p>
<details>
    <summary>Are you ready for this?</summary>
<p></p>
On the homepage you will notice the Champlain College Digital Forensics Association's Logo. Can you decipher the hidden message?
</details>

<p></p>
<hr>
<p></p>

<H3>Deadbox Forensics</H3>
<p></p>
<details>
    <summary>Challenges</summary>
<p></p>

<details>
    <summary>Hello, my name is...</summary>
<p></p>
What is the name of the examiner who created the E01?
<p></p>
<details>
    <summary>Walkthrough</summary>
<p></p>

<details>
    <summary>Answer</summary>
<p></p>

</details>
</details>
</details>

<p></p>
<hr>
<p></p>

<details>
    <summary>Who owns it?</summary>
<p></p>
What is the username of the primary user of the machine?
<p></p>
<details>
    <summary>Walkthrough</summary>
<p></p>

<details>
    <summary>Answer</summary>
<p></p>

</details>
</details>
</details>

<p></p>
<hr>
<p></p>

<details>
    <summary>Does it match?</summary>
<p></p>
What is the SHA1 hash of the evidence?
<p></p>
<details>
    <summary>Walkthrough</summary>
<p></p>

<details>
    <summary>Answer</summary>
<p></p>

</details>
</details>
</details>

<p></p>
<hr>
<p></p>

<details>
    <summary>The Big Bang</summary>
<p></p>
What time was the image created? Submit in UTC as MM/DD/YYYY HH:MM:SS in 24 format
<p></p>
<details>
    <summary>Walkthrough</summary>
<p></p>

<details>
    <summary>Answer</summary>
<p></p>

</details>
</details>
</details>

<p></p>
<hr>
<p></p>

<details>
    <summary>Which window is it?</summary>
<p></p>
What OS is installed on this computer? Windows ____
<p></p>
<details>
    <summary>Walkthrough</summary>
<p></p>

<details>
    <summary>Answer</summary>
<p></p>

</details>
</details>
</details>

<p></p>
<hr>
<p></p>

<details>
    <summary>The worst thing about prison were the dementors!</summary>
<p></p>
There appears to be a theme used when creating the E01. What is the theme? (Case Sensitive, two words)
<p></p>
<details>
    <summary>Walkthrough</summary>
<p></p>

<details>
    <summary>Answer</summary>
<p></p>

</details>
</details>
</details>

<p></p>
<hr>
<p></p>

<details>
    <summary>Brooms aren't just for sweeping</summary>
<p></p>
What is the decoded name of the Evidence File?
<p></p>
<details>
    <summary>Walkthrough</summary>
<p></p>

<details>
    <summary>Answer</summary>
<p></p>

</details>
</details>
</details>

<p></p>
<hr>
<p></p>

<details>
    <summary>Russia</summary>
<p></p>
What is the hostname of the Windows partition?
<p></p>
<details>
    <summary>Walkthrough</summary>
<p></p>

<details>
    <summary>Answer</summary>
<p></p>

</details>
</details>
</details>

<p></p>
<hr>
<p></p>

<details>
    <summary>Let's chat</summary>
<p></p>
A messaging platform was used to communicate with a fellow Alpaca enthusiast, what is the name of the software?
<p></p>
<details>
    <summary>Walkthrough</summary>
<p></p>

<details>
    <summary>Answer</summary>
<p></p>

</details>
</details>
</details>

<p></p>
<hr>
<p></p>

<details>
    <summary>Zippy Zip</summary>
<p></p>
What is the zipcode of Karen's craigslist post?
<p></p>
<details>
    <summary>Walkthrough</summary>
<p></p>

<details>
    <summary>Answer</summary>
<p></p>

</details>
</details>
</details>

<p></p>
<hr>
<p></p>

<details>
    <summary>New email, who dis?</summary>
<p></p>
What are the initials of the person who contacted Karen?
<p></p>
<details>
    <summary>Walkthrough</summary>
<p></p>

<details>
    <summary>Answer</summary>
<p></p>

</details>
</details>
</details>

<p></p>
<hr>
<p></p>

<details>
    <summary>Make it rain!</summary>
<p></p>
How much money was TAAUSAI willing to pay Karen upfront? Answer without commas or dollar signs.
<p></p>
<details>
    <summary>Walkthrough</summary>
<p></p>

<details>
    <summary>Answer</summary>
<p></p>

</details>
</details>
</details>

<p></p>
<hr>
<p></p>

<details>
    <summary>You have no idea how high I can fly</summary>
<p></p>
What country is Karen meeting the hacker group in?
<p></p>
<details>
    <summary>Walkthrough</summary>
<p></p>

<details>
    <summary>Answer</summary>
<p></p>

</details>
</details>
</details>

<p></p>
<hr>
<p></p>

<details>
    <summary>Where in the world is Carmen Sandiego?</summary>
<p></p>
What is the timezone? (Use the three letter abbreviation)
<p></p>
<details>
    <summary>Walkthrough</summary>
<p></p>

<details>
    <summary>Answer</summary>
<p></p>

</details>
</details>
</details>

<p></p>
<hr>
<p></p>

<details>
    <summary>Someone actually read that?</summary>
<p></p>
What is the Last Accessed time for AlpacaCare.docx? Submit in UTC as MM/DD/YYYY HH:MM:SS in 24 format
<p></p>
<details>
    <summary>Walkthrough</summary>
<p></p>

<details>
    <summary>Answer</summary>
<p></p>

</details>
</details>
</details>

<p></p>
<hr>
<p></p>

<details>
    <summary>Partition Suspicion</summary>
<p></p>
Karen had a second partition on the drive, what drive letter was it assigned?
<p></p>
<details>
    <summary>Walkthrough</summary>
<p></p>

<details>
    <summary>Answer</summary>
<p></p>

</details>
</details>
</details>

<p></p>
<hr>
<p></p>

<details>
    <summary>You've got questions? I've got answers</summary>
<p></p>
What is the answer to the question Michael's manager asks Karen?
<p></p>
<details>
    <summary>Walkthrough</summary>
<p></p>

<details>
    <summary>Answer</summary>
<p></p>

</details>
</details>
</details>

<p></p>
<hr>
<p></p>

<details>
    <summary>Recruit Pursuit</summary>
<p></p>
What job is Karen told she is being considered for? Answer should be submitted with no spaces and all lowercase.
<p></p>
<details>
    <summary>Walkthrough</summary>
<p></p>

<details>
    <summary>Answer</summary>
<p></p>

</details>
</details>
</details>

<p></p>
<hr>
<p></p>

<details>
    <summary>Oh, you're not supposed to use the same password for everything...?</summary>
<p></p>
When was Karens password last changed? Submit in UTC as MM:DD:YYYY HH:MM:YYYY in 24 format
<p></p>
<details>
    <summary>Walkthrough</summary>
<p></p>

<details>
    <summary>Answer</summary>
<p></p>

</details>
</details>
</details>

<p></p>
<hr>
<p></p>

<details>
    <summary>Are you sure you want to change your default browser?</summary>
<p></p>
What Version of Chrome is installed on the machine?
<p></p>
<details>
    <summary>Walkthrough</summary>
<p></p>

<details>
    <summary>Answer</summary>
<p></p>

</details>
</details>
</details>

<p></p>
<hr>
<p></p>

<details>
    <summary>iS tHiS sP@M?</summary>
<p></p>
Karen received a reply to her craigslist ad from a fellow Alpaca enthusiast, what is the email address associated with this reply?
<p></p>
<details>
    <summary>Walkthrough</summary>
<p></p>

<details>
    <summary>Answer</summary>
<p></p>

</details>
</details>
</details>

<p></p>
<hr>
<p></p>

<details>
    <summary>Moooooooooo</summary>
<p></p>
What is the tool Karen hopes to learn to use? This question is case sensitive.
<p></p>
<details>
    <summary>Walkthrough</summary>
<p></p>

<details>
    <summary>Answer</summary>
<p></p>

</details>
</details>
</details>

<p></p>
<hr>
<p></p>

<details>
    <summary>She's a ladies man</summary>
<p></p>
What was the volume name of the second partition on the laptop?
<p></p>
<details>
    <summary>Walkthrough</summary>
<p></p>

<details>
    <summary>Answer</summary>
<p></p>

</details>
</details>
</details>

<p></p>
<hr>
<p></p>

<details>
    <summary>now with 99% more ads</summary>
<p></p>
What is the HostUrl of Skype?
<p></p>
<details>
    <summary>Walkthrough</summary>
<p></p>

<details>
    <summary>Answer</summary>
<p></p>

</details>
</details>
</details>

<p></p>
<hr>
<p></p>

<details>
    <summary>her name is snow</summary>
<p></p>
Bob told Karen the name of his favorite Alpaca. What is the name?
<p></p>
<details>
    <summary>Walkthrough</summary>
<p></p>

<details>
    <summary>Answer</summary>
<p></p>

</details>
</details>
</details>

<p></p>
<hr>
<p></p>

<details>
    <summary>rev2md5</summary>
<p></p>
Find the file with MD5 2BD8E82961FC29BBBCF0083D0811A9DB. It will lead you to victory.
<p></p>
Update: The link found from this file is no longer active. The flag has been updated to accept the full URL which the link points to. 
<p></p>
<details>
    <summary>Walkthrough</summary>
<p></p>

<details>
    <summary>Answer</summary>
<p></p>

</details>
</details>
</details>

<p></p>
<hr>
<p></p>

<details>
    <summary>AlpacaCare2020</summary>
<p></p>
What is the domain name of the website Karen browsed on Alpaca care that the file AlpacaCare.docx is based on?
<p></p>
<details>
    <summary>Walkthrough</summary>
<p></p>

<details>
    <summary>Answer</summary>
<p></p>

</details>
</details>
</details>

<p></p>
<hr>
<p></p>

<details>
    <summary>You have secrets?</summary>
<p></p>
What is the Created Timestamp for the secret file? Submit in UTC as MM/DD/YYYY HH:MM:SS in 24 format.
<p></p>
Hint: Secrets are best kept hidden in plain sight.
<p></p>
<details>
    <summary>Walkthrough</summary>
<p></p>

<details>
    <summary>Answer</summary>
<p></p>

</details>
</details>
</details>

<p></p>
<hr>
<p></p>

<details>
    <summary>DrDD</summary>
<p></p>
Duanes Challenge: Duane Dunston had his passwords hijacked. Karen hid them C:\Users\Karen\Desktop\DuanesChallenge somewhere, what is the password to Duane's LinkedIn?
<p></p>
<details>
    <summary>Walkthrough</summary>
<p></p>

<details>
    <summary>Answer</summary>
<p></p>

</details>
</details>
</details>




</details>

<p></p>
<hr>
<p></p>

<H3>Linux Forensics</H3>
<p></p>
<details>
    <summary>Challenges</summary>
<p></p>

<details>
    <summary>red star</summary>
<p></p>
What distribution of Linux is being used on this machine?
<p></p>
<details>
    <summary>Walkthrough</summary>
<p></p>

<details>
    <summary>Answer</summary>
<p></p>

</details>
</details>
</details>

<p></p>
<hr>
<p></p>

<details>
    <summary>abc123</summary>
<p></p>
What is the MD5 hash of the apache access.log?
<p></p>
<details>
    <summary>Walkthrough</summary>
<p></p>

<details>
    <summary>Answer</summary>
<p></p>

</details>
</details>
</details>

<p></p>
<hr>
<p></p>

<details>
    <summary>Radiohead - No Surprises</summary>
<p></p>
It is believed that a credential dumping tool was downloaded? What is the file name of the download?
<p></p>
<details>
    <summary>Walkthrough</summary>
<p></p>

<details>
    <summary>Answer</summary>
<p></p>

</details>
</details>
</details>

<p></p>
<hr>
<p></p>

<details>
    <summary>super duper secret</summary>
<p></p>
There was a super secret file created, what is the absolute path?
<p></p>
<details>
    <summary>Walkthrough</summary>
<p></p>

<details>
    <summary>Answer</summary>
<p></p>

</details>
</details>
</details>

<p></p>
<hr>
<p></p>

<details>
    <summary>this is a hard one</summary>
<p></p>
What program used didyouthinkwedmakeiteasy.jpg during execution?
<p></p>
<details>
    <summary>Walkthrough</summary>
<p></p>

<details>
    <summary>Answer</summary>
<p></p>

</details>
</details>
</details>

<p></p>
<hr>
<p></p>

<details>
    <summary>overachiever</summary>
<p></p>
What is the third goal from the checklist Karen created?
<p></p>
<details>
    <summary>Walkthrough</summary>
<p></p>

<details>
    <summary>Answer</summary>
<p></p>

</details>
</details>
</details>

<p></p>
<hr>
<p></p>

<details>
    <summary>attack helicopter</summary>
<p></p>
How many times was apache run?
<p></p>
<details>
    <summary>Walkthrough</summary>
<p></p>

<details>
    <summary>Answer</summary>
<p></p>

</details>
</details>
</details>

<p></p>
<hr>
<p></p>

<details>
    <summary>oh no some1 call ic3</summary>
<p></p>
It is believed this machine was used to attack another, what file proves this?
<p></p>
<details>
    <summary>Walkthrough</summary>
<p></p>

<details>
    <summary>Answer</summary>
<p></p>

</details>
</details>
</details>

<p></p>
<hr>
<p></p>

<details>
    <summary>scripters prevail</summary>
<p></p>
Within the Documents file path, it is believed that Karen was taunting a fellow computer expert through a bash script. Who was Karen taunting?
<p></p>
<details>
    <summary>Walkthrough</summary>
<p></p>

<details>
    <summary>Answer</summary>
<p></p>

</details>
</details>
</details>

<p></p>
<hr>
<p></p>

<details>
    <summary>the who</summary>
<p></p>
A user su'd to root at 11:26 multiple times. Who was it?
<p></p>
<details>
    <summary>Walkthrough</summary>
<p></p>

<details>
    <summary>Answer</summary>
<p></p>

</details>
</details>
</details>

<p></p>
<hr>
<p></p>

<details>
    <summary>/</summary>
<p></p>
Based on the bash history, what is the current working directory?
<p></p>
<details>
    <summary>Walkthrough</summary>
<p></p>

<details>
    <summary>Answer</summary>
<p></p>

</details>
</details>
</details>



</details>

<p></p>
<hr>
<p></p>

<H3>Memory Forensics</H3>
<p></p>
https://github.com/Shadow-Admins/Cyber_Club/tree/main/Starting_Point/DFIR/Memory_Forensics/Volatility

<p></p>
<hr>
<p></p>

<H3>Triage VM Questions</H3>
<p></p>
a
<details>
    <summary>Challenges</summary>
<p></p>

```
3 part challenge                                                                                                                                              
-------------------------------------------------------------------------------------------------                                                             
Challenge designed as a series, first DCO are given a compromised system memory dump, DCO figure out whats happening on the system and hand it off to OCO,    
OCO conduct boot to root on attacker system, attacker uploads malware to the original system, DCO then have to investigate the malware.                       
                                                                                                                                                              
This challenge attempts to replicate the process of hand off of work between parties working together.                                                        
                                                                                                                                                              
                                                                                                                                                              
part 1 - Memory Forensics                                                                                                                                     
-------------------------------------------------------------------------------------------------                                                             
Outline: you are given a memory dump and told that this computer has been compromised somehow.                                                                
                                                                                                                                                              
chal 1 - what is the md5 hash of the memory dump? (md5sum mem.mem)                                                                                            
chal 2 - what is the memory profile of the dump? (most likely Win7SP1x64, possibly a win10 profile?) (dependant on if I can get win10 image to work, will     
        require download of win10 profile IOT run analysis)                                                                                                   
chal 3 - does the pc have an ip address? (netscan, system ip address)                                                                                         
chal 4 - what is the pcname? (envars or pull registry key for computername)                                                                                   
chal 5 - what is the users password? (requires hash dump and NTLM password crack)                                                                             
chal 6 - how did the attacker get the pc's password? (bash bunny password dump attack) (will have to identify this occuring, ? memdump of process and then    
        identify that a bashbunny was used, bash bunny running lasagnia IOT dump passwords)                                                                   
chal 7 - what time did the attack occur? (run timeliner and serach for the attack time)                                                                       
chal 8 - identify the Pid of the process that dumped the password. (pstree - dependant on Pid of the bashbunny)                                               
chal 9 - ? a .dll challenge associated with the .dll from the password dump (dlllist followed by dll dump IOT get flag from dll analysis)                     
chal 10 - the computers webcam was on and captured a picture of the attacker, you have been given a folder of suspects can you identify the attacker?         
        (use facial recognition software to identify the attacker from a folder of facial images)                                                             
chal 11 - a strange device was found plugged into the back of the pc, it seems to have been capturing network activity, analyse the packet capture and        
        identify where the network activity is being sent to (packet squirel or lan turtle)                                                                   
chal 12 - something was installed on the computer during the attack, identify what was installed (trojan horse, back door?)                                   
chal 13 - what is the md5 hash of the installed trojan on the pc?          
chal 14 - VAD challenge start and end location that is from the trojan Pid
chal 15 - what was written in notepad.exe at the time of the attack?
chal 16 -  What is the shortname of the file at file record ........?

Part 2 - Boot to Root on attackers machine, running kali linux
-------------------------------------------------------------------------------------------------------------
Outline: DCO hand off the found IP address to OCO who then conduct an attack on the system

Chal 1 - nmap scan ip identify how many ports are open
chal 2 - ? ftp break in
chal 3 - dirty sock priv esc?
chals - add more

Part 3 - Malware analysis
-------------------------------------------------------------------------------------------------------------
Outline: The attacker noticed his machine was being attacked and in a last ditch effort installed malware on the system

chal 1 - what is the Pid of the malware that is running? (pstree)
chal 2 - what is the md5 hash of the malware? (procdump --> md5sum)
chal 3 - extract the graphics from the malware (dump malware, use foremost, get image, image error use hex edit to add magic bytes, colour shift to get flag)
chal 4 - is the malware known? (hidden tear, thor-lite or virus total)
chal 5 - what is the type of malware? (ransomware)
chal 6 - what is the bit coin address? (strings -el | grep coin)
chal 7 - what is the malwares control server? (strings -el | grep or use .NET decomiler to locate)
chal 8 - what is the encryption password? (.NET decompiler, PCNAME-USER PASSWORD)
chal 9 - decrypt the secret password decryptor using previously found password) 
```






</details>